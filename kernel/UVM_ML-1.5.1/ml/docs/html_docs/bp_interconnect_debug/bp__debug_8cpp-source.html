<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>UVM-ML: backplane/bp_debug.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_4d03515e09ef9c1905bf5de32d00e494.html">backplane</a></div>
<h1>bp_debug.cpp</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00002"></a>00002 <span class="comment">//   Copyright 2012 Cadence Design Systems, Inc.</span>
<a name="l00003"></a>00003 <span class="comment">//   Copyright 2012-2013 Advanced Micro Devices Inc.</span>
<a name="l00004"></a>00004 <span class="comment">//   All Rights Reserved Worldwide</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">//   Licensed under the Apache License, Version 2.0 (the</span>
<a name="l00007"></a>00007 <span class="comment">//   "License"); you may not use this file except in</span>
<a name="l00008"></a>00008 <span class="comment">//   compliance with the License.  You may obtain a copy of</span>
<a name="l00009"></a>00009 <span class="comment">//   the License at</span>
<a name="l00010"></a>00010 <span class="comment">//</span>
<a name="l00011"></a>00011 <span class="comment">//       http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00012"></a>00012 <span class="comment">//</span>
<a name="l00013"></a>00013 <span class="comment">//   Unless required by applicable law or agreed to in</span>
<a name="l00014"></a>00014 <span class="comment">//   writing, software distributed under the License is</span>
<a name="l00015"></a>00015 <span class="comment">//   distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR</span>
<a name="l00016"></a>00016 <span class="comment">//   CONDITIONS OF ANY KIND, either express or implied.  See</span>
<a name="l00017"></a>00017 <span class="comment">//   the License for the specific language governing</span>
<a name="l00018"></a>00018 <span class="comment">//   permissions and limitations under the License.</span>
<a name="l00019"></a>00019 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// for copy</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;iterator&gt;</span> <span class="comment">// for ostream_iterator</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#include "<a class="code" href="bp__interconnect_8h.html">bp_interconnect.h</a>"</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include "bp_top_descriptor.h"</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="keyword">namespace </span>Bp 
<a name="l00032"></a>00032 {
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="comment">// Phase debug</span>
<a name="l00035"></a>00035 BpInterconnect::BpStopRequestClass <a class="code" href="classBp_1_1BpInterconnect.html#d2fe768ecfc493ebdbb22c61b8dace7c">BpInterconnect::m_debug_requests</a>;
<a name="l00036"></a>00036 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                       BpInterconnect::BpStopRequestClass::m_last_id = 0;
<a name="l00037"></a>00037 vector&lt;BpInterconnect::BpStopRequestClass::bp_stop_request_struct*&gt; 
<a name="l00038"></a>00038                                    <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">BpInterconnect::BpStopRequestClass::m_requests</a>;
<a name="l00039"></a>00039 string                             <a class="code" href="classBp_1_1BpInterconnect.html#e58388011a09500455ccc8c55ad5eaa4">BpInterconnect::m_current_phase_name</a>;
<a name="l00040"></a>00040 <span class="keywordtype">bool</span>                               <a class="code" href="classBp_1_1BpInterconnect.html#2e670879ea1b9c669b66b1274b97351f">BpInterconnect::m_first_phase</a>;
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 vector&lt;string&gt;                     BpInterconnect::BpDebugClass::m_command_backlog;
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">// BpStopRequestClass</span>
<a name="l00045"></a>00045 
<a name="l00046"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#2b685c056ff073615c1905303bdf47ae">00046</a> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#2b685c056ff073615c1905303bdf47ae">BpInterconnect::BpStopRequestClass::BpStopRequestClass</a> () {};
<a name="l00047"></a>00047 
<a name="l00048"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#388e279acbdbcf2d933a64e828e4eaef">00048</a> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#388e279acbdbcf2d933a64e828e4eaef">BpInterconnect::BpStopRequestClass::~BpStopRequestClass</a>() {};
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="comment">// /////////////////////////////////////////////////</span>
<a name="l00051"></a>00051 <span class="comment">// check if stop request is pending for this phase</span>
<a name="l00052"></a>00052 <span class="comment">// /////////////////////////////////////////////////</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#0baba7b5f061a2606bc56a5d523023f6">00055</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#0baba7b5f061a2606bc56a5d523023f6">BpInterconnect::BpStopRequestClass::CheckStopRequest</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *        phase_name, 
<a name="l00056"></a>00056                                                           uvm_ml_phase_action phase_action) 
<a name="l00057"></a>00057 {
<a name="l00058"></a>00058     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.size(); i++) {
<a name="l00059"></a>00059 
<a name="l00060"></a>00060         <span class="keywordflow">if</span> (<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>[i]-&gt;phase_action == phase_action &amp;&amp; 
<a name="l00061"></a>00061             !strcmp(<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>[i]-&gt;phase_name.c_str(), phase_name))
<a name="l00062"></a>00062         {
<a name="l00063"></a>00063           string beginOrEnd;
<a name="l00064"></a>00064           <span class="keywordflow">switch</span>(<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>[i]-&gt;phase_action)
<a name="l00065"></a>00065           {
<a name="l00066"></a>00066             <span class="keywordflow">case</span> UVM_ML_PHASE_STARTED:
<a name="l00067"></a>00067               beginOrEnd = <span class="stringliteral">"begin"</span>; 
<a name="l00068"></a>00068               <span class="keywordflow">break</span>;
<a name="l00069"></a>00069             <span class="keywordflow">case</span> UVM_ML_PHASE_ENDED:
<a name="l00070"></a>00070               beginOrEnd = <span class="stringliteral">"end"</span>;
<a name="l00071"></a>00071               <span class="keywordflow">break</span>;
<a name="l00072"></a>00072             <span class="keywordflow">default</span>:
<a name="l00073"></a>00073               <span class="keywordflow">break</span>;
<a name="l00074"></a>00074           }
<a name="l00075"></a>00075           PrintMessage(<span class="stringliteral">"UVM-ML: Stopping at phase %s %s"</span>, <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>[i]-&gt;phase_name.c_str(), beginOrEnd.c_str());
<a name="l00076"></a>00076             <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// found pending request</span>
<a name="l00077"></a>00077         } 
<a name="l00078"></a>00078     }
<a name="l00079"></a>00079     <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no pending request for this phase</span>
<a name="l00080"></a>00080 };
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#cf6399ccc995d98402e86d8a8980058e">00082</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#cf6399ccc995d98402e86d8a8980058e">BpInterconnect::BpStopRequestClass::PrintStop</a> (bp_stop_request_struct * req) 
<a name="l00083"></a>00083 { 
<a name="l00084"></a>00084     PrintMessage (<span class="stringliteral">"UVM-ML: Stop #%d %s %s"</span>, req-&gt;id, req-&gt;phase_name.c_str(), 
<a name="l00085"></a>00085              (req-&gt;phase_action == UVM_ML_PHASE_STARTED) ? <span class="stringliteral">"begin"</span>:<span class="stringliteral">"end"</span>);
<a name="l00086"></a>00086 }
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#26f3ebd39c85447d4ca896a1a5130cb8">00088</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#26f3ebd39c85447d4ca896a1a5130cb8">BpInterconnect::BpStopRequestClass::CheckPhaseName</a> (bp_stop_request_struct * req) {
<a name="l00089"></a>00089     <span class="keywordflow">if</span>(!req-&gt;checked &amp;&amp; !<a class="code" href="classBp_1_1BpInterconnect.html#8c3ea0928b653830d2457db4d43b3443">PhaseSrvCheckPhase</a>(req-&gt;phase_name.c_str())) {
<a name="l00090"></a>00090         ErrorMsg(<span class="stringliteral">"CheckPhaseName found stop request with unsupported phase '%s'"</span>, req-&gt;phase_name.c_str());
<a name="l00091"></a>00091     }
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 
<a name="l00095"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#9d8c1adfeb2da0fff2fb3e7794148a73">00095</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#9d8c1adfeb2da0fff2fb3e7794148a73">BpInterconnect::BpStopRequestClass::RequestStopPhase</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *phase_name, 
<a name="l00096"></a>00096                                                           uvm_ml_phase_action phase_action)
<a name="l00097"></a>00097 {
<a name="l00098"></a>00098     <span class="keywordflow">if</span>(<a class="code" href="classBp_1_1BpInterconnect.html#2e670879ea1b9c669b66b1274b97351f">m_first_phase</a>) { <span class="comment">// phase service provider already initialized</span>
<a name="l00099"></a>00099         <span class="keywordflow">if</span>(!<a class="code" href="classBp_1_1BpInterconnect.html#8c3ea0928b653830d2457db4d43b3443">PhaseSrvCheckPhase</a>(phase_name)) {
<a name="l00100"></a>00100             ErrorMsg(<span class="stringliteral">"Could not set stop on unrecognized phase '%s'"</span>, phase_name);
<a name="l00101"></a>00101             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00102"></a>00102         }
<a name="l00103"></a>00103         <span class="keywordflow">if</span>(!<a class="code" href="classBp_1_1BpInterconnect.html#16e05da4e59f41d1cfd68bcd1d5aafdb">PhaseSrvCheckFuturePhase</a>(phase_name, phase_action)) {
<a name="l00104"></a>00104             ErrorMsg(<span class="stringliteral">"Could not set stop on phase that passed '%s'"</span>, phase_name);
<a name="l00105"></a>00105             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00106"></a>00106         }
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108     <span class="keywordflow">if</span>(phase_action != UVM_ML_PHASE_STARTED &amp;&amp; phase_action != UVM_ML_PHASE_ENDED) {
<a name="l00109"></a>00109       ErrorMsg(<span class="stringliteral">"Invalid phase action (must be either 'begin' or 'end'"</span>);
<a name="l00110"></a>00110       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112     <span class="comment">// skip if already set</span>
<a name="l00113"></a>00113     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.size(); i++) {
<a name="l00114"></a>00114         <span class="keywordflow">if</span> (!strcmp(<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>[i]-&gt;phase_name.c_str(), phase_name) &amp;&amp;
<a name="l00115"></a>00115              <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>[i]-&gt;phase_action == phase_action) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00116"></a>00116     };
<a name="l00117"></a>00117     <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.push_back(<span class="keyword">new</span> bp_stop_request_struct(phase_name, phase_action, <a class="code" href="classBp_1_1BpInterconnect.html#2e670879ea1b9c669b66b1274b97351f">m_first_phase</a>));
<a name="l00118"></a>00118     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00119"></a>00119 }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="comment">// cancel pending request</span>
<a name="l00123"></a>00123 <span class="comment">// ////////////////////////</span>
<a name="l00124"></a>00124 
<a name="l00125"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#0b3cfc06e696a812aed604f6a416aeff">00125</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#0b3cfc06e696a812aed604f6a416aeff">BpInterconnect::BpStopRequestClass::CancelStopPhase</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *        phase_name, 
<a name="l00126"></a>00126                                                          uvm_ml_phase_action phase_action)
<a name="l00127"></a>00127 {
<a name="l00128"></a>00128     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.size(); i++) {
<a name="l00129"></a>00129         <span class="keywordflow">if</span> (!strcmp(<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>[i]-&gt;phase_name.c_str(), phase_name) &amp;&amp;
<a name="l00130"></a>00130              <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>[i]-&gt;phase_action == phase_action) 
<a name="l00131"></a>00131         {
<a name="l00132"></a>00132             <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.erase(<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.begin()+i);
<a name="l00133"></a>00133             <span class="keywordflow">return</span>;
<a name="l00134"></a>00134         } 
<a name="l00135"></a>00135     }
<a name="l00136"></a>00136     ErrorMsg(<span class="stringliteral">"Request to be canceled was not found"</span>);
<a name="l00137"></a>00137 }
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="comment">// ////////////////////////</span>
<a name="l00140"></a>00140 <span class="comment">// list pending requests</span>
<a name="l00141"></a>00141 <span class="comment">// ////////////////////////</span>
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#b848db15f3c1fab2dc2423728228b7ad">00143</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#b848db15f3c1fab2dc2423728228b7ad">BpInterconnect::BpStopRequestClass::ListStopRequests</a>()
<a name="l00144"></a>00144 {
<a name="l00145"></a>00145     std::for_each(<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.begin(), <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.end(), <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#cf6399ccc995d98402e86d8a8980058e">PrintStop</a>);
<a name="l00146"></a>00146 }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="comment">// ////////////////////////</span>
<a name="l00149"></a>00149 <span class="comment">// Delete a stop request</span>
<a name="l00150"></a>00150 <span class="comment">// ////////////////////////</span>
<a name="l00151"></a>00151 
<a name="l00152"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#3aee338fb4e253c9e45ddf1d657a1c96">00152</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#3aee338fb4e253c9e45ddf1d657a1c96">BpInterconnect::BpStopRequestClass::DeleteStopRequest</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * index)
<a name="l00153"></a>00153 {
<a name="l00154"></a>00154     <span class="keywordtype">int</span> i;
<a name="l00155"></a>00155     i = atoi(index);
<a name="l00156"></a>00156     <span class="keywordflow">if</span>((i &gt; 0) &amp;&amp; (i &lt;= (<span class="keywordtype">int</span>) m_last_id)) {
<a name="l00157"></a>00157         <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.erase(<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.begin()+i-1);
<a name="l00158"></a>00158     } <span class="keywordflow">else</span> {
<a name="l00159"></a>00159         ErrorMsg(<span class="stringliteral">"Illegal index value in delete command"</span>);
<a name="l00160"></a>00160     }
<a name="l00161"></a>00161 }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="comment">// Get current phase</span>
<a name="l00164"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#9a9907d31c19212f3c24ca98631e6458">00164</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#9a9907d31c19212f3c24ca98631e6458">BpInterconnect::BpStopRequestClass::GetPhaseRequest</a>()
<a name="l00165"></a>00165 {
<a name="l00166"></a>00166     <span class="keywordflow">if</span> (m_srv_providers.phase_srv_provider) {
<a name="l00167"></a>00167       <span class="keywordflow">if</span> (<a class="code" href="classBp_1_1BpInterconnect.html#e58388011a09500455ccc8c55ad5eaa4">m_current_phase_name</a>.empty())
<a name="l00168"></a>00168         PrintMessage(<span class="stringliteral">"UVM-ML: Phasing has not been started yet"</span>);
<a name="l00169"></a>00169       <span class="keywordflow">else</span>
<a name="l00170"></a>00170         PrintMessage(<span class="stringliteral">"UVM-ML: Current phase is %s"</span>, <a class="code" href="classBp_1_1BpInterconnect.html#e58388011a09500455ccc8c55ad5eaa4">m_current_phase_name</a>.c_str());
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172     <span class="keywordflow">else</span>
<a name="l00173"></a>00173       ErrorMsg(<span class="stringliteral">"Phasing service provider is not available"</span>);
<a name="l00174"></a>00174 }
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 <span class="comment">// Cancel all phase requests</span>
<a name="l00177"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#4ecbc39a4822d8fc0636a9d9e4f255cd">00177</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#4ecbc39a4822d8fc0636a9d9e4f255cd">BpInterconnect::BpStopRequestClass::CancelPhaseRequests</a>()
<a name="l00178"></a>00178 {
<a name="l00179"></a>00179     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.size(); ) {
<a name="l00180"></a>00180         <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.erase(<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#ef8f0323fecd7e7cad9ac845e1ff8dc3">m_requests</a>.begin());
<a name="l00181"></a>00181     }
<a name="l00182"></a>00182 }
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">// ////////////////////////</span>
<a name="l00185"></a>00185 <span class="comment">// Print tree</span>
<a name="l00186"></a>00186 <span class="comment">// ////////////////////////</span>
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 <span class="comment">// Count the number of dots in path</span>
<a name="l00189"></a>00189 <span class="keywordtype">int</span> BpInterconnect::BpCommandPrintTree::count_dots(string name) {
<a name="l00190"></a>00190     <span class="keywordtype">int</span> cnt = 0;
<a name="l00191"></a>00191     std::size_t found = name.find_first_of(<span class="stringliteral">"."</span>);
<a name="l00192"></a>00192     <span class="keywordflow">while</span> (found!=std::string::npos) {
<a name="l00193"></a>00193         cnt++;
<a name="l00194"></a>00194         found=name.find_first_of(<span class="stringliteral">"."</span>,found+1);
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196     <span class="keywordflow">return</span> cnt;
<a name="l00197"></a>00197 };
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 
<a name="l00200"></a>00200   
<a name="l00201"></a>00201 <span class="keywordtype">bool</span> BpInterconnect::BpCommandPrintTree::IsChildProxy(<span class="keyword">const</span> string &amp; current_name,
<a name="l00202"></a>00202                                                 string &amp; target_name,
<a name="l00203"></a>00203                                                 <span class="keywordtype">int</span> * target_ind) 
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; m_child_proxy_registry.size(); j++) {
<a name="l00206"></a>00206         <span class="keywordflow">if</span>(m_child_proxy_registry[j]-&gt;GetName() == current_name) {
<a name="l00207"></a>00207             <span class="keywordtype">int</span> target_fw = m_child_proxy_registry[j]-&gt;GetTargetFrameworkId();
<a name="l00208"></a>00208             FrameworkProxyClass * target = GetFramework(target_fw);
<a name="l00209"></a>00209             <span class="keyword">const</span> vector&lt;string&gt; &amp; target_indicators = target-&gt;GetIndicators();
<a name="l00210"></a>00210             target_name = target_indicators[0];
<a name="l00211"></a>00211             *target_ind = target_fw;
<a name="l00212"></a>00212             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00213"></a>00213         };
<a name="l00214"></a>00214     };
<a name="l00215"></a>00215     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00216"></a>00216 };
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="keywordtype">bool</span> BpInterconnect::BpCommandPrintTree::IsComponentToTraverse(FrameworkProxyClass * frmw, <span class="keyword">const</span> string &amp; child_name)
<a name="l00219"></a>00219 {
<a name="l00220"></a>00220   string dummy_name;
<a name="l00221"></a>00221   <span class="keywordtype">int</span> dummy_index;
<a name="l00222"></a>00222 
<a name="l00223"></a>00223   <span class="keywordflow">return</span> m_val.show_port || IsChildProxy(child_name, dummy_name, &amp;dummy_index) || !frmw-&gt;IsPort(child_name);
<a name="l00224"></a>00224 }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 <span class="keywordtype">bool</span> BpInterconnect::BpCommandPrintTree::HasChildrenToTraverse(FrameworkProxyClass * frmw, <span class="keyword">const</span> string &amp; current_name)
<a name="l00227"></a>00227 {
<a name="l00228"></a>00228   <span class="keywordtype">int</span> num = frmw-&gt;GetNumChildren(current_name);
<a name="l00229"></a>00229   <span class="keywordflow">if</span> (num &lt;= 0)
<a name="l00230"></a>00230     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00231"></a>00231 
<a name="l00232"></a>00232   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; num; i++) {
<a name="l00233"></a>00233     string child_name = frmw-&gt;GetChildName(current_name, i);
<a name="l00234"></a>00234     <span class="keywordflow">if</span>(!child_name.empty()) 
<a name="l00235"></a>00235       <span class="keywordflow">if</span> (IsComponentToTraverse(frmw, child_name))
<a name="l00236"></a>00236         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00237"></a>00237   }
<a name="l00238"></a>00238   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00239"></a>00239 }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 <span class="keywordtype">bool</span> 
<a name="l00242"></a>00242 BpInterconnect::BpCommandPrintTree::PrintSubtree(<span class="keyword">const</span> string &amp; current_name,
<a name="l00243"></a>00243                                                  FrameworkProxyClass * frmw,
<a name="l00244"></a>00244                                                  string frmw_name,
<a name="l00245"></a>00245                                                  string prefix,
<a name="l00246"></a>00246                                                  <span class="keywordtype">int</span> current_level,
<a name="l00247"></a>00247                                                  <span class="keywordtype">int</span> root_level, 
<a name="l00248"></a>00248                                                  <span class="keywordtype">bool</span> skip_proxy, 
<a name="l00249"></a>00249                                                  <span class="keywordtype">int</span> frmw_name_len) 
<a name="l00250"></a>00250 { 
<a name="l00251"></a>00251     string target_name;
<a name="l00252"></a>00252     <span class="keywordtype">int</span> target_index;
<a name="l00253"></a>00253 
<a name="l00254"></a>00254     <span class="comment">// skip printing if not under requested root and not printing the proxy itself</span>
<a name="l00255"></a>00255     <span class="keywordflow">if</span>((m_val.root_name.empty() || BpPrefixCompare(m_val.root_name, current_name)) &amp;&amp; !skip_proxy) {
<a name="l00256"></a>00256         string msg;
<a name="l00257"></a>00257         string fw_name = frmw_name.substr(0,frmw_name_len);
<a name="l00258"></a>00258         msg = fw_name + <span class="stringliteral">":"</span> + string(frmw_name_len-fw_name.size(), <span class="charliteral">' '</span>);
<a name="l00259"></a>00259         <span class="keywordflow">if</span>(m_val.show_full_path) {
<a name="l00260"></a>00260             msg += current_name;
<a name="l00261"></a>00261         } <span class="keywordflow">else</span> { <span class="comment">// indented tree</span>
<a name="l00262"></a>00262             msg += prefix;
<a name="l00263"></a>00263             size_t last = current_name.find_last_of(<span class="stringliteral">"."</span>);
<a name="l00264"></a>00264             msg += current_name.substr(last+1);
<a name="l00265"></a>00265         };
<a name="l00266"></a>00266         
<a name="l00267"></a>00267         <span class="keywordflow">if</span>(m_val.show_type) { <span class="comment">// add type name</span>
<a name="l00268"></a>00268             msg = msg + <span class="stringliteral">" ["</span> + frmw-&gt;GetComponentTypeName(current_name) + <span class="stringliteral">"]"</span>;
<a name="l00269"></a>00269         };
<a name="l00270"></a>00270         <span class="keywordflow">if</span> (m_val.depth != -1 
<a name="l00271"></a>00271                 &amp;&amp; current_level == m_val.depth-1+root_level  <span class="comment">//truncated due to the depth parameter</span>
<a name="l00272"></a>00272                 &amp;&amp; HasChildrenToTraverse(frmw, current_name)) {
<a name="l00273"></a>00273             msg += <span class="stringliteral">" .../ ..."</span>;
<a name="l00274"></a>00274             m_components_unshown_by_depth = <span class="keyword">true</span>;
<a name="l00275"></a>00275         }
<a name="l00276"></a>00276         PrintMessage(msg);
<a name="l00277"></a>00277     };
<a name="l00278"></a>00278     
<a name="l00279"></a>00279     <span class="comment">// iterate on all child components</span>
<a name="l00280"></a>00280     <span class="keywordtype">int</span> num = frmw-&gt;GetNumChildren(current_name);
<a name="l00281"></a>00281     <span class="keywordflow">switch</span>(num)
<a name="l00282"></a>00282     {
<a name="l00283"></a>00283         <span class="keywordflow">case</span> -1:
<a name="l00284"></a>00284           <span class="keywordflow">if</span>(!IsChildProxy(current_name, target_name, &amp;target_index)) {
<a name="l00285"></a>00285               <span class="comment">//In a case of a "sandwitch" hierarchy with the single component in the middle layer, there may be two components</span>
<a name="l00286"></a>00286               <span class="comment">//with the same hierarchical name. In this marginal scenario, get_num_children() returns (-1) as it's a wrong hierarchy.</span>
<a name="l00287"></a>00287               <span class="comment">//We are working around this issue here.</span>
<a name="l00288"></a>00288               PrintMessage(<span class="stringliteral">"*** ERROR Could not find number of children for %s"</span>, current_name.c_str());
<a name="l00289"></a>00289               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00290"></a>00290             }
<a name="l00291"></a>00291             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00292"></a>00292         <span class="keywordflow">case</span> 0:
<a name="l00293"></a>00293             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00294"></a>00294     } 
<a name="l00295"></a>00295 
<a name="l00296"></a>00296     <span class="comment">// Update prefix for children</span>
<a name="l00297"></a>00297     <span class="keywordflow">if</span>(prefix.size() &gt;= 3) {
<a name="l00298"></a>00298         <span class="keywordflow">if</span>(prefix.substr(prefix.size()-3,prefix.size()) == <span class="stringliteral">"\\__"</span>) {
<a name="l00299"></a>00299             prefix = prefix.substr(0, prefix.size()-3) + <span class="stringliteral">"   "</span>;
<a name="l00300"></a>00300         };
<a name="l00301"></a>00301     };
<a name="l00302"></a>00302     <span class="keywordflow">if</span>(m_val.depth == -1 || current_level &lt; m_val.depth-1+root_level) { <span class="comment">// check max level</span>
<a name="l00303"></a>00303         <span class="keywordflow">if</span>(prefix == <span class="stringliteral">""</span>) prefix = <span class="stringliteral">"|__"</span>; 
<a name="l00304"></a>00304         <span class="keywordflow">else</span> prefix = prefix.substr(0,prefix.size()-2) + <span class="stringliteral">"  |__"</span>;
<a name="l00305"></a>00305         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; num; i++) {
<a name="l00306"></a>00306             string child_name = frmw-&gt;GetChildName(current_name, i);
<a name="l00307"></a>00307             <span class="keywordflow">if</span>(strcmp(child_name.c_str(), <span class="stringliteral">""</span>)) {
<a name="l00308"></a>00308                 <span class="keywordflow">if</span>(i == num-1) 
<a name="l00309"></a>00309                     prefix = prefix.substr(0,prefix.size()-3) + <span class="stringliteral">"\\__"</span>;
<a name="l00310"></a>00310                  <span class="comment">// recursive call excluding ports unless requested</span>
<a name="l00311"></a>00311                 <span class="keywordflow">if</span>(IsComponentToTraverse(frmw, child_name)) {
<a name="l00312"></a>00312                     <span class="keywordtype">bool</span> res;
<a name="l00313"></a>00313                     <span class="keywordflow">if</span>(IsChildProxy(child_name, target_name, &amp;target_index)) {
<a name="l00314"></a>00314                         FrameworkProxyClass *target = GetFramework(target_index);
<a name="l00315"></a>00315                         res = PrintSubtree(child_name, target, target_name, prefix, current_level+1, root_level, <span class="keyword">false</span>, frmw_name_len);
<a name="l00316"></a>00316                         <span class="keywordflow">if</span> (!res) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00317"></a>00317                         <span class="comment">// explore children of proxy without printing the proxy itself</span>
<a name="l00318"></a>00318                         res = PrintSubtree(child_name, frmw, frmw_name, prefix, current_level+1, root_level, <span class="keyword">true</span>, frmw_name_len);
<a name="l00319"></a>00319                     } <span class="keywordflow">else</span> {
<a name="l00320"></a>00320                         res = PrintSubtree(child_name, frmw, frmw_name, prefix, current_level+1, root_level, <span class="keyword">false</span>, frmw_name_len);
<a name="l00321"></a>00321                     };
<a name="l00322"></a>00322                     <span class="keywordflow">if</span> (!res) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00323"></a>00323                 };
<a name="l00324"></a>00324             };
<a name="l00325"></a>00325         };
<a name="l00326"></a>00326         prefix = prefix.substr(0,prefix.size()-3);
<a name="l00327"></a>00327     };
<a name="l00328"></a>00328     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00329"></a>00329 };
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="keywordtype">void</span> BpInterconnect::BpCommandPrintConnections::PrintPair(BpConnectionClass * src, BpConnectionClass * trg, <span class="keyword">const</span> string &amp;arrow, <span class="keywordtype">bool</span> show_type) {
<a name="l00333"></a>00333   <span class="keywordflow">if</span> (!m_item_is_printed)
<a name="l00334"></a>00334   {
<a name="l00335"></a>00335       PrintMessage(<span class="stringliteral">"List of UVM-ML connections: "</span>);
<a name="l00336"></a>00336       m_item_is_printed = <span class="keyword">true</span>;
<a name="l00337"></a>00337   }
<a name="l00338"></a>00338   string msg = src-&gt;GetFrmw()-&gt;GetName() + <span class="stringliteral">":"</span> + src-&gt;GetPath();
<a name="l00339"></a>00339   <span class="keywordflow">if</span>(show_type) 
<a name="l00340"></a>00340     msg += src-&gt;GetTypeName();
<a name="l00341"></a>00341   PrintMessage(msg);
<a name="l00342"></a>00342 
<a name="l00343"></a>00343   msg = arrow + trg-&gt;GetFrmw()-&gt;GetName()  + <span class="stringliteral">":"</span> + trg-&gt;GetPath();
<a name="l00344"></a>00344   <span class="keywordflow">if</span>(show_type) 
<a name="l00345"></a>00345     msg += trg-&gt;GetTypeName();
<a name="l00346"></a>00346   PrintMessage(msg);
<a name="l00347"></a>00347 }
<a name="l00348"></a>00348 
<a name="l00349"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpDebugClass.html#e7d6b9719546999c33b50e01dcd7af09">00349</a> <span class="keywordtype">int</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpDebugClass.html#e7d6b9719546999c33b50e01dcd7af09">BpInterconnect::BpDebugClass::ExecuteCommand</a>(<span class="keywordtype">int</span>              frameworkId,
<a name="l00350"></a>00350                                                  <span class="keyword">const</span> string &amp;   command_with_arguments,
<a name="l00351"></a>00351                                                  bp_output_cb_t * outputCb,
<a name="l00352"></a>00352                                                  uvm_ml_time_unit timeUnit, 
<a name="l00353"></a>00353                                                  <span class="keywordtype">double</span>           timeValue)
<a name="l00354"></a>00354 {
<a name="l00355"></a>00355 
<a name="l00356"></a>00356   <a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">exec_status</a> <a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">exec_status</a> = UVM_ML_UNRECOGNIZED_COMMAND;<span class="comment">//assume failure as initial status</span>
<a name="l00357"></a>00357   <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html">BpPredefinedCommand</a> *predefined_cmd = NULL;
<a name="l00358"></a>00358   <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html">BpCommandBase</a> *cmd = NULL;
<a name="l00359"></a>00359 
<a name="l00360"></a>00360   <span class="keywordflow">if</span> ((predefined_cmd = GetCommand(command_with_arguments)) != NULL) 
<a name="l00361"></a>00361   {
<a name="l00362"></a>00362     <span class="keywordflow">switch</span>(predefined_cmd-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#6e0eb6a1c715b93c03df47f33ec64179">GetMatchResult</a>())
<a name="l00363"></a>00363     {
<a name="l00364"></a>00364       <span class="keywordflow">case</span> BpCommandOptionsBase::MATCH_CMD_INVALID_OPTIONS:
<a name="l00365"></a>00365         <span class="keywordflow">return</span> UVM_ML_COMMAND_FAILURE;
<a name="l00366"></a>00366       <span class="keywordflow">case</span> BpCommandOptionsBase::HELP_OPTION:
<a name="l00367"></a>00367         predefined_cmd-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#3fa29c64356c22349a432c0fb7232ff9">PrintCmdHelp</a>();
<a name="l00368"></a>00368         <span class="keywordflow">return</span> UVM_ML_COMMAND_SUCCESS;
<a name="l00369"></a>00369       <span class="keywordflow">default</span>:
<a name="l00370"></a>00370         <span class="keywordflow">break</span>;
<a name="l00371"></a>00371     }
<a name="l00372"></a>00372 
<a name="l00373"></a>00373     predefined_cmd-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#6f8791c64e3e675e5c06fb40357402e6">ResetAndInit</a>(command_with_arguments, frameworkId);
<a name="l00374"></a>00374     <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#1ef5dfe69d8c3cf66de5a4300a7f4309">BpCommandOptionsBase::parse_status</a> parse_status = 
<a name="l00375"></a>00375       predefined_cmd-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#db67bc23ee80dba866a1ba5a177bba23">GetParser</a>()-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#9080dd1caea155d07e04c692a2251e14">ParseCheckSyntax</a>(command_with_arguments);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377     <span class="keywordflow">switch</span>(parse_status)
<a name="l00378"></a>00378     {
<a name="l00379"></a>00379       <span class="keywordflow">case</span> BpCommandOptionsBase::PARSE_FAILURE:
<a name="l00380"></a>00380         <span class="keywordflow">return</span> UVM_ML_COMMAND_FAILURE;
<a name="l00381"></a>00381       <span class="keywordflow">case</span> BpCommandOptionsBase::ASKED_FOR_HELP:
<a name="l00382"></a>00382         predefined_cmd-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#3fa29c64356c22349a432c0fb7232ff9">PrintCmdHelp</a>();
<a name="l00383"></a>00383         <span class="keywordflow">return</span> UVM_ML_COMMAND_SUCCESS;
<a name="l00384"></a>00384       <span class="keywordflow">case</span> UVM_ML_COMMAND_SUCCESS:
<a name="l00385"></a>00385         <span class="keywordflow">break</span>;
<a name="l00386"></a>00386     }
<a name="l00387"></a>00387     cmd = predefined_cmd;       
<a name="l00388"></a>00388   }
<a name="l00389"></a>00389   <span class="keywordflow">else</span> 
<a name="l00390"></a>00390   {
<a name="l00391"></a>00391     <span class="keywordflow">if</span> (GenericCmdHelpRequired(command_with_arguments))
<a name="l00392"></a>00392     {
<a name="l00393"></a>00393       BpPredefinedCommand::PrintGenericCommandHelp();
<a name="l00394"></a>00394       <span class="keywordflow">return</span> UVM_ML_COMMAND_SUCCESS; 
<a name="l00395"></a>00395     }
<a name="l00396"></a>00396     <span class="comment">//unrecognized command, assumed custom command to be broadcasted</span>
<a name="l00397"></a>00397     cmd = <a class="code" href="classBp_1_1BpInterconnect_1_1BpCustomCommand.html#6ae031a7f9e06684058d8c5c2da450fb">BpCustomCommand::GetInstance</a>();
<a name="l00398"></a>00398     cmd-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#9b0b5c1952cb3cb805d59b1ad29c1e50">ResetAndInit</a>(command_with_arguments, frameworkId);
<a name="l00399"></a>00399   }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401   <span class="keywordflow">try</span>
<a name="l00402"></a>00402   {
<a name="l00403"></a>00403     cmd-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#1674019f7e0dcd8d17d4d6d2ec5dd7e9">TraceExecute</a>(frameworkId);
<a name="l00404"></a>00404     exec_status = cmd-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#bb24060e256521d5e3c6e736d8d02039">Execute</a>(outputCb, 
<a name="l00405"></a>00405                                timeUnit,
<a name="l00406"></a>00406                                timeValue);
<a name="l00407"></a>00407     cmd-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#f0335037ce30927456f8722f14b000c0">TraceResult</a>(exec_status); 
<a name="l00408"></a>00408   }
<a name="l00409"></a>00409   <span class="keywordflow">catch</span>(<span class="keywordtype">int</span>)
<a name="l00410"></a>00410   {
<a name="l00411"></a>00411     ErrorMsg(<span class="stringliteral">"execution of the UVM-ML debug command '%s' failed due to exception occured"</span>, command_with_arguments.c_str());
<a name="l00412"></a>00412     exec_status = UVM_ML_COMMAND_FAILURE;
<a name="l00413"></a>00413   }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415   <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)exec_status;
<a name="l00416"></a>00416 }
<a name="l00417"></a>00417 
<a name="l00418"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpDebugClass.html#fcf68febf60a62b8b97a8595e5263d0e">00418</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpDebugClass.html#fcf68febf60a62b8b97a8595e5263d0e">BpInterconnect::BpDebugClass::Reset</a>()
<a name="l00419"></a>00419 {
<a name="l00420"></a>00420     m_command_backlog.clear();
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 vector&lt;BpInterconnect::BpPredefinedCommand *&gt; BpInterconnect::BpPredefinedCommand::m_predef_commands;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426 <span class="keywordtype">void</span> BpInterconnect::BpPredefinedCommand::Init()
<a name="l00427"></a>00427 {
<a name="l00428"></a>00428   <span class="keywordflow">if</span> (m_predef_commands.empty())
<a name="l00429"></a>00429   {
<a name="l00430"></a>00430     m_predef_commands.push_back(GetInstance&lt;BpCommandPrintTree&gt;());
<a name="l00431"></a>00431     m_predef_commands.push_back(GetInstance&lt;BpCommandPrintConnections&gt;());
<a name="l00432"></a>00432     m_predef_commands.push_back(GetInstance&lt;BpCommandPhase&gt;());
<a name="l00433"></a>00433     m_predef_commands.push_back(GetInstance&lt;BpCommandTraceRegister&gt;());
<a name="l00434"></a>00434   }
<a name="l00435"></a>00435 }
<a name="l00436"></a>00436 
<a name="l00437"></a>00437 BpInterconnect::BpPredefinedCommand *BpInterconnect::BpDebugClass::GetCommand(<span class="keyword">const</span> string &amp;command_with_arguments)
<a name="l00438"></a>00438 {
<a name="l00439"></a>00439   BpPredefinedCommand::Init();
<a name="l00440"></a>00440 
<a name="l00441"></a>00441   vector&lt;BpPredefinedCommand *&gt;::iterator it;
<a name="l00442"></a>00442   <span class="keywordflow">for</span>(it = BpPredefinedCommand::m_predef_commands.begin(); 
<a name="l00443"></a>00443       it != BpPredefinedCommand::m_predef_commands.end(); 
<a name="l00444"></a>00444       it++)
<a name="l00445"></a>00445   {
<a name="l00446"></a>00446     <span class="keywordflow">if</span> (*it != NULL)
<a name="l00447"></a>00447     {
<a name="l00448"></a>00448       BpPredefinedCommand* cmd_ptr = *it;
<a name="l00449"></a>00449       <span class="keywordflow">if</span> (cmd_ptr-&gt;MatchCommand(command_with_arguments))
<a name="l00450"></a>00450         <span class="keywordflow">return</span> cmd_ptr;
<a name="l00451"></a>00451     }
<a name="l00452"></a>00452   }    
<a name="l00453"></a>00453   <span class="keywordflow">return</span> NULL;
<a name="l00454"></a>00454 }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 <span class="keywordtype">bool</span> BpInterconnect::BpDebugClass::GenericCmdHelpRequired(<span class="keyword">const</span> string &amp;command_with_arguments)
<a name="l00457"></a>00457 {
<a name="l00458"></a>00458   string basename = GetToken(command_with_arguments);
<a name="l00459"></a>00459   <span class="keywordflow">if</span>(!basename.empty())
<a name="l00460"></a>00460   {
<a name="l00461"></a>00461     <span class="keywordflow">if</span> ((basename == <span class="stringliteral">"-help"</span>) || (basename == <span class="stringliteral">"-h"</span>))
<a name="l00462"></a>00462       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00463"></a>00463     <span class="keywordflow">if</span> (!isalpha(basename[0])) <span class="comment">//the command name should start with character</span>
<a name="l00464"></a>00464     {
<a name="l00465"></a>00465       ErrorMsg(<span class="stringliteral">"Invalid UVM-ML debugging command: \"%s\""</span>, command_with_arguments.c_str());
<a name="l00466"></a>00466       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00467"></a>00467     }
<a name="l00468"></a>00468   }
<a name="l00469"></a>00469   <span class="keywordflow">else</span>
<a name="l00470"></a>00470     <span class="keywordflow">return</span> <span class="keyword">true</span>;<span class="comment">//empty or spaces only - print help</span>
<a name="l00471"></a>00471 
<a name="l00472"></a>00472   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00473"></a>00473 }
<a name="l00474"></a>00474 
<a name="l00475"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#b1fb66cbd9f01feb43ecd50a66d5536a">00475</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#b1fb66cbd9f01feb43ecd50a66d5536a">BpInterconnect::BpPredefinedCommand::MatchCommand</a>(<span class="keyword">const</span> string &amp;command_with_arguments)
<a name="l00476"></a>00476 {
<a name="l00477"></a>00477   <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#7926f193823ecfdd1a86eb8a9b298da3">m_match_result</a> = <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#43fb10b1ea19edaa97a6c1800ba3a58c">MatchesCommandName</a>(command_with_arguments) ? 
<a name="l00478"></a>00478     BpCommandOptionsBase::MATCH : 
<a name="l00479"></a>00479     BpCommandOptionsBase::MISMATCH;
<a name="l00480"></a>00480 
<a name="l00481"></a>00481   <span class="keywordflow">return</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#7926f193823ecfdd1a86eb8a9b298da3">m_match_result</a> == BpCommandOptionsBase::MATCH;
<a name="l00482"></a>00482 }
<a name="l00483"></a>00483 
<a name="l00484"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#aa73a56946201c5c112bb385b2126e5d">00484</a> <span class="keywordtype">bool</span>  <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#aa73a56946201c5c112bb385b2126e5d">BpInterconnect::BpCommandPhase::MatchCommand</a>(<span class="keyword">const</span> string &amp;command_with_arguments)
<a name="l00485"></a>00485 {
<a name="l00486"></a>00486   <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#8e2911cd1f08c819dd62e8ed2f076425">SetMandatoryOptionVariant</a>(<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#8b010a4d39d577e5caa1ec1e089d1cea">NO_MANDATORY_VARIANT</a>);
<a name="l00487"></a>00487 
<a name="l00488"></a>00488   <span class="keywordflow">if</span> (<a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#43fb10b1ea19edaa97a6c1800ba3a58c">MatchesCommandName</a>(command_with_arguments))
<a name="l00489"></a>00489   {
<a name="l00490"></a>00490     <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#7926f193823ecfdd1a86eb8a9b298da3">m_match_result</a> = m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpPhaseCommandOptions.html#4d550d80448c0497e2311a82d491865c">MatchMandatoryOption</a>(command_with_arguments);
<a name="l00491"></a>00491     <span class="keywordflow">return</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#7926f193823ecfdd1a86eb8a9b298da3">m_match_result</a> != BpCommandOptionsBase::MISMATCH;<span class="comment">//returns true for MATCH, MATCH_CMD_INVALID_OPTIONS, HELP_OPTION</span>
<a name="l00492"></a>00492   }
<a name="l00493"></a>00493   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00494"></a>00494 }
<a name="l00495"></a>00495 
<a name="l00496"></a>00496 <span class="keywordtype">void</span> BpInterconnect::BpPredefinedCommand::PrintGenericCommandHelp()
<a name="l00497"></a>00497 {
<a name="l00498"></a>00498   PrintMessage(<span class="stringliteral">"Usage:\t\tuvm_ml &lt;command&gt;| -h | -help\nThe predefined commands are: "</span>);
<a name="l00499"></a>00499   Init();
<a name="l00500"></a>00500 
<a name="l00501"></a>00501   string msg;
<a name="l00502"></a>00502   vector&lt;BpPredefinedCommand *&gt;::iterator it;
<a name="l00503"></a>00503   <span class="keywordflow">for</span>(it = m_predef_commands.begin(); it != m_predef_commands.end(); it++)
<a name="l00504"></a>00504   {
<a name="l00505"></a>00505     <span class="keywordflow">if</span> (*it)
<a name="l00506"></a>00506     {
<a name="l00507"></a>00507       <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html">BpPredefinedCommand</a> *cmd = *it;
<a name="l00508"></a>00508       msg += cmd-&gt;<a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#4f6940b6899ec312832bd1f33fe0e344">Name</a>();
<a name="l00509"></a>00509       <span class="keywordflow">if</span> (*it != m_predef_commands.back())
<a name="l00510"></a>00510         msg += <span class="stringliteral">", "</span>;
<a name="l00511"></a>00511     }
<a name="l00512"></a>00512   } 
<a name="l00513"></a>00513   msg += <span class="stringliteral">"\nCall &lt;command&gt; -help to get the command-specific information\n"</span>;  
<a name="l00514"></a>00514   PrintMessage(msg.c_str());
<a name="l00515"></a>00515 }
<a name="l00516"></a>00516 
<a name="l00517"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#3fa29c64356c22349a432c0fb7232ff9">00517</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#3fa29c64356c22349a432c0fb7232ff9">BpInterconnect::BpPredefinedCommand::PrintCmdHelp</a>()
<a name="l00518"></a>00518 {
<a name="l00519"></a>00519   stringstream ss;
<a name="l00520"></a>00520   ss &lt;&lt; <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#4f6940b6899ec312832bd1f33fe0e344">Name</a>();
<a name="l00521"></a>00521   copy(<a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#23e6ef72d771423fb443165e2e6aa700">m_cmd_help</a>.begin(), <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#23e6ef72d771423fb443165e2e6aa700">m_cmd_help</a>.end(), ostream_iterator&lt;string&gt;(ss, <span class="stringliteral">"\n"</span>));
<a name="l00522"></a>00522   PrintMessage(ss.str());
<a name="l00523"></a>00523 }
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 <a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">BpInterconnect::exec_status</a> 
<a name="l00526"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#97aca509959ee2a498f7c595f4a12200">00526</a> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#97aca509959ee2a498f7c595f4a12200">BpInterconnect::BpCommandBase::DoBroadcastCommand</a>(bp_output_cb_t * outputCb,
<a name="l00527"></a>00527                                                   uvm_ml_time_unit timeUnit,
<a name="l00528"></a>00528                                                   <span class="keywordtype">double</span>           timeValue,
<a name="l00529"></a>00529                                                   <span class="keywordtype">bool</span> addBacklog)
<a name="l00530"></a>00530 {
<a name="l00531"></a>00531   <span class="keyword">const</span> <span class="keywordtype">char</span> *command_with_args = <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#a7cc71ed7eb148e6ef5b43c1df5a4d83">GetExternalCommand</a>().c_str();
<a name="l00532"></a>00532   <a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">exec_status</a> status = UVM_ML_UNRECOGNIZED_COMMAND;
<a name="l00533"></a>00533   
<a name="l00534"></a>00534   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; GetFrameworkRegistry().size(); i++)
<a name="l00535"></a>00535   {
<a name="l00536"></a>00536     FrameworkProxyClass * frmw = GetFrameworkRegistry()[i];
<a name="l00537"></a>00537     <span class="keywordflow">if</span> (frmw)
<a name="l00538"></a>00538     {
<a name="l00539"></a>00539       <span class="keywordtype">int</span> res = frmw-&gt;NotifyCommand(command_with_args, outputCb, timeUnit, timeValue);
<a name="l00540"></a>00540       <span class="keywordflow">if</span> (res == (<span class="keywordtype">int</span>)UVM_ML_COMMAND_FAILURE) 
<a name="l00541"></a>00541       {
<a name="l00542"></a>00542         ErrorMsg(<span class="stringliteral">"Command '%s' request failed for framework %s"</span>, command_with_args, frmw-&gt;GetName().c_str());
<a name="l00543"></a>00543         <span class="keywordflow">return</span> UVM_ML_COMMAND_FAILURE;
<a name="l00544"></a>00544       }
<a name="l00545"></a>00545       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == UVM_ML_COMMAND_SUCCESS)
<a name="l00546"></a>00546         status = UVM_ML_COMMAND_SUCCESS;
<a name="l00547"></a>00547     }
<a name="l00548"></a>00548     <span class="keywordflow">else</span>
<a name="l00549"></a>00549       ErrorMsg(<span class="stringliteral">"Failed to get framework (%d) for the command %s"</span>, i, command_with_args);
<a name="l00550"></a>00550   }
<a name="l00551"></a>00551 
<a name="l00552"></a>00552   <span class="keywordflow">if</span> (addBacklog &amp;&amp; (m_elaboration_passed == <span class="keyword">false</span>))
<a name="l00553"></a>00553     <a class="code" href="classBp_1_1BpInterconnect_1_1BpDebugClass.html#d1b63a4ea39673230efd6f2c9c758ac4">BpDebugClass::AddBacklogCommand</a>(command_with_args);
<a name="l00554"></a>00554 
<a name="l00555"></a>00555   <span class="keywordflow">return</span> status;
<a name="l00556"></a>00556 }
<a name="l00557"></a>00557 
<a name="l00558"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#6955c175f5f5ded925d5c3f86a364154">00558</a> string <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#6955c175f5f5ded925d5c3f86a364154">BpInterconnect::BpCommandBase::CommandOriginated</a>(<span class="keywordtype">int</span> frameworkId)
<a name="l00559"></a>00559 {
<a name="l00560"></a>00560   string origin;
<a name="l00561"></a>00561   <span class="keywordflow">if</span> (frameworkId == (-1)) origin = <span class="stringliteral">"interactively"</span>;
<a name="l00562"></a>00562   <span class="keywordflow">else</span>
<a name="l00563"></a>00563     origin = string(<span class="stringliteral">"by "</span>) + GetFramework(frameworkId)-&gt;GetName() + <span class="stringliteral">" adapter"</span>;
<a name="l00564"></a>00564 
<a name="l00565"></a>00565   <span class="keywordflow">return</span> origin;
<a name="l00566"></a>00566 }
<a name="l00567"></a>00567 
<a name="l00568"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpInternalCommand.html#50ffac0390d6406a276d68146d028654">00568</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpInternalCommand.html#50ffac0390d6406a276d68146d028654">BpInterconnect::BpInternalCommand::TraceExecute</a>(<span class="keywordtype">int</span> frameworkId)
<a name="l00569"></a>00569 {
<a name="l00570"></a>00570   DebugTrace(<span class="stringliteral">"Executing command '%s' originated %s"</span>, <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#4f6940b6899ec312832bd1f33fe0e344">Name</a>().c_str(), <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#6955c175f5f5ded925d5c3f86a364154">CommandOriginated</a>(frameworkId).c_str());
<a name="l00571"></a>00571 }
<a name="l00572"></a>00572 
<a name="l00573"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpInternalCommand.html#c4f4c280597219787b0de7656edb9fbf">00573</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpInternalCommand.html#c4f4c280597219787b0de7656edb9fbf">BpInterconnect::BpInternalCommand::TraceResult</a>(<a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">exec_status</a> result)
<a name="l00574"></a>00574 {
<a name="l00575"></a>00575   <span class="keywordflow">switch</span>(result)
<a name="l00576"></a>00576   {
<a name="l00577"></a>00577     <span class="keywordflow">case</span> UVM_ML_COMMAND_SUCCESS:
<a name="l00578"></a>00578       DebugTrace(<span class="stringliteral">"Command '%s' passed successfully."</span>, <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#4f6940b6899ec312832bd1f33fe0e344">Name</a>().c_str());
<a name="l00579"></a>00579       <span class="keywordflow">break</span>;
<a name="l00580"></a>00580     <span class="keywordflow">case</span> UVM_ML_COMMAND_FAILURE:
<a name="l00581"></a>00581       DebugTrace(<span class="stringliteral">"Command '%s' failed%s"</span>, 
<a name="l00582"></a>00582                  <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#4f6940b6899ec312832bd1f33fe0e344">Name</a>().c_str(), 
<a name="l00583"></a>00583                  <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#d21bd922f7879ffee532582b363ee0c2">m_execute_err</a>.empty() ? <span class="stringliteral">"."</span> : (string(<span class="stringliteral">": "</span>) + <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#d21bd922f7879ffee532582b363ee0c2">m_execute_err</a>).c_str());      
<a name="l00584"></a>00584       <span class="keywordflow">break</span>;
<a name="l00585"></a>00585     <span class="keywordflow">default</span>:
<a name="l00586"></a>00586       assert(<span class="keyword">false</span>); <span class="comment">//internal commands cannot be unrecognized</span>
<a name="l00587"></a>00587   }
<a name="l00588"></a>00588 }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590 
<a name="l00591"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpExternalCommand.html#8e60eb23b185e6ae841fefc00247c0a9">00591</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpExternalCommand.html#8e60eb23b185e6ae841fefc00247c0a9">BpInterconnect::BpExternalCommand::TraceExecute</a>(<span class="keywordtype">int</span> frameworkId)
<a name="l00592"></a>00592 {
<a name="l00593"></a>00593   string msg_format = <span class="stringliteral">"Broadcasting command '%s' originated %s, to framework adapters"</span>;
<a name="l00594"></a>00594   <span class="keywordflow">if</span> (m_elaboration_passed == <span class="keyword">false</span>)
<a name="l00595"></a>00595     msg_format += <span class="stringliteral">", it is also backlogged for later broadcasting."</span>;
<a name="l00596"></a>00596   DebugTrace(msg_format.c_str(), <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#a7cc71ed7eb148e6ef5b43c1df5a4d83">GetExternalCommand</a>().c_str(), <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#6955c175f5f5ded925d5c3f86a364154">CommandOriginated</a>(frameworkId).c_str());
<a name="l00597"></a>00597 }
<a name="l00598"></a>00598 
<a name="l00599"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpExternalCommand.html#c3ecc1ba8e30a84f810eeb940686a721">00599</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpExternalCommand.html#c3ecc1ba8e30a84f810eeb940686a721">BpInterconnect::BpExternalCommand::TraceResult</a>(<a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">exec_status</a> result)
<a name="l00600"></a>00600 {
<a name="l00601"></a>00601   <span class="keywordflow">switch</span>(result)
<a name="l00602"></a>00602   {
<a name="l00603"></a>00603     <span class="keywordflow">case</span> UVM_ML_COMMAND_SUCCESS:
<a name="l00604"></a>00604       DebugTrace(<span class="stringliteral">"Command '%s' passed successfully."</span>, <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#a7cc71ed7eb148e6ef5b43c1df5a4d83">GetExternalCommand</a>().c_str());
<a name="l00605"></a>00605       <span class="keywordflow">break</span>;
<a name="l00606"></a>00606     <span class="keywordflow">case</span> UVM_ML_COMMAND_FAILURE:
<a name="l00607"></a>00607       <span class="keywordflow">break</span>; <span class="comment">//for broadcasted command failure is reported immediately</span>
<a name="l00608"></a>00608     <span class="keywordflow">case</span> UVM_ML_UNRECOGNIZED_COMMAND:
<a name="l00609"></a>00609       <span class="keywordflow">if</span> (m_elaboration_passed == <span class="keyword">false</span>)
<a name="l00610"></a>00610         WarningMsg(<span class="stringliteral">"No framework had recognized the command request: %s\n"</span>
<a name="l00611"></a>00611                    <span class="stringliteral">"                     it will be backlogged until the beginning of pre-run phases\n"</span>
<a name="l00612"></a>00612                    <span class="stringliteral">"                     and it will be tried on each framework that registers itself by that time"</span>,
<a name="l00613"></a>00613                    <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#a7cc71ed7eb148e6ef5b43c1df5a4d83">GetExternalCommand</a>().c_str());
<a name="l00614"></a>00614       <span class="keywordflow">else</span> 
<a name="l00615"></a>00615         ErrorMsg(<span class="stringliteral">"No framework had recognized the command request: %s"</span>, <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#a7cc71ed7eb148e6ef5b43c1df5a4d83">GetExternalCommand</a>().c_str());
<a name="l00616"></a>00616   }
<a name="l00617"></a>00617 }
<a name="l00618"></a>00618 
<a name="l00619"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCustomCommand.html#f5ee6e849194bf4be83fe6b986de6b54">00619</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCustomCommand.html#f5ee6e849194bf4be83fe6b986de6b54">BpInterconnect::BpCustomCommand::TraceExecute</a>(<span class="keywordtype">int</span> frameworkId)
<a name="l00620"></a>00620 {
<a name="l00621"></a>00621   DebugTrace(<span class="stringliteral">"Broadcasting command '%s' originated %s, to framework adapters"</span>,  <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#a7cc71ed7eb148e6ef5b43c1df5a4d83">GetExternalCommand</a>().c_str(), <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#6955c175f5f5ded925d5c3f86a364154">CommandOriginated</a>(frameworkId).c_str());
<a name="l00622"></a>00622 }
<a name="l00623"></a>00623 
<a name="l00624"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCustomCommand.html#24e3d4b1ac72364bb2cded395b88b2c9">00624</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCustomCommand.html#24e3d4b1ac72364bb2cded395b88b2c9">BpInterconnect::BpCustomCommand::TraceResult</a>(<a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">exec_status</a> result)
<a name="l00625"></a>00625 {
<a name="l00626"></a>00626   <span class="keywordflow">switch</span>(result)
<a name="l00627"></a>00627   {
<a name="l00628"></a>00628     <span class="keywordflow">case</span> UVM_ML_COMMAND_SUCCESS:
<a name="l00629"></a>00629       DebugTrace(<span class="stringliteral">"Command '%s' passed successfully."</span>, <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#a7cc71ed7eb148e6ef5b43c1df5a4d83">GetExternalCommand</a>().c_str());
<a name="l00630"></a>00630     <span class="keywordflow">case</span> UVM_ML_COMMAND_FAILURE:
<a name="l00631"></a>00631       <span class="keywordflow">break</span>; <span class="comment">//for broadcasted command failure is reported immediately</span>
<a name="l00632"></a>00632     <span class="keywordflow">case</span> UVM_ML_UNRECOGNIZED_COMMAND:
<a name="l00633"></a>00633       <span class="keywordflow">if</span> (m_elaboration_passed == <span class="keyword">false</span>)
<a name="l00634"></a>00634         WarningMsg(<span class="stringliteral">"No framework had recognized command request: %s"</span>, <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#a7cc71ed7eb148e6ef5b43c1df5a4d83">GetExternalCommand</a>().c_str());
<a name="l00635"></a>00635       <span class="keywordflow">else</span> 
<a name="l00636"></a>00636         ErrorMsg(<span class="stringliteral">"No framework had recognized command request '%s'; it might be misspelled"</span>, <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#a7cc71ed7eb148e6ef5b43c1df5a4d83">GetExternalCommand</a>().c_str());
<a name="l00637"></a>00637   }
<a name="l00638"></a>00638 }
<a name="l00639"></a>00639 
<a name="l00640"></a>00640 
<a name="l00641"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#72f3c147cfbd0bd1a5e9b72dba7ef011">00641</a> <a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">BpInterconnect::exec_status</a> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#72f3c147cfbd0bd1a5e9b72dba7ef011">BpInterconnect::BpCommandPrintTree::Execute</a>(bp_output_cb_t * outputCb,
<a name="l00642"></a>00642                                                                         uvm_ml_time_unit timeUnit,
<a name="l00643"></a>00643                                                                         <span class="keywordtype">double</span> timeValue)
<a name="l00644"></a>00644 {
<a name="l00645"></a>00645   string prefix = <span class="stringliteral">""</span>;
<a name="l00646"></a>00646   <span class="keywordtype">int</span> current_level = 0;
<a name="l00647"></a>00647   <span class="keywordtype">int</span> root_level = count_dots(m_val.root_name);
<a name="l00648"></a>00648   <span class="keywordtype">unsigned</span> len = 1;
<a name="l00649"></a>00649   <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;
<a name="l00650"></a>00650 
<a name="l00651"></a>00651   <span class="comment">// ToDo Check if build phase is done</span>
<a name="l00652"></a>00652 
<a name="l00653"></a>00653   <span class="comment">// find max len of framework name</span>
<a name="l00654"></a>00654   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; m_top_level_registry.size(); j++) {
<a name="l00655"></a>00655     BpTopDescriptorClass * top = m_top_level_registry[j];
<a name="l00656"></a>00656     string frmw_name = top-&gt;GetFrameworkIndicator(); <span class="comment">//frmw-&gt;GetName()</span>
<a name="l00657"></a>00657     <span class="keywordflow">if</span>(frmw_name.size() &gt; len) len = frmw_name.size();
<a name="l00658"></a>00658     FrameworkProxyClass * frmw = top-&gt;GetFrmw();
<a name="l00659"></a>00659     frmw_name = frmw-&gt;GetName();
<a name="l00660"></a>00660     <span class="keywordflow">if</span>(frmw_name.size() &gt; len) len = frmw_name.size();
<a name="l00661"></a>00661   };
<a name="l00662"></a>00662   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; m_child_proxy_registry.size(); j++) {
<a name="l00663"></a>00663     <span class="keywordtype">int</span> target_fw = m_child_proxy_registry[j]-&gt;GetTargetFrameworkId();
<a name="l00664"></a>00664     FrameworkProxyClass * target = GetFramework(target_fw);
<a name="l00665"></a>00665     <span class="keyword">const</span> vector&lt;string&gt; &amp; target_indicators = target-&gt;GetIndicators();
<a name="l00666"></a>00666     string frmw_name = target_indicators[0];
<a name="l00667"></a>00667     <span class="keywordflow">if</span>(frmw_name.size() &gt; len) len = frmw_name.size();
<a name="l00668"></a>00668   };
<a name="l00669"></a>00669 
<a name="l00670"></a>00670   <span class="comment">// Collect the trees of all top components</span>
<a name="l00671"></a>00671   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; m_top_level_registry.size(); j++) {
<a name="l00672"></a>00672     BpTopDescriptorClass * top = m_top_level_registry[j];
<a name="l00673"></a>00673     FrameworkProxyClass * frmw = top-&gt;GetFrmw();
<a name="l00674"></a>00674     <span class="keyword">const</span> string &amp; top_name = top-&gt;GetInstanceName();
<a name="l00675"></a>00675     string root = m_val.root_name.substr(0,m_val.root_name.find_first_of(<span class="stringliteral">"."</span>));
<a name="l00676"></a>00676     
<a name="l00677"></a>00677     <span class="keywordflow">if</span>(m_val.root_name.empty() || BpPrefixCompare(root, top_name)) {
<a name="l00678"></a>00678       string frmw_name = top-&gt;GetFrameworkIndicator(); <span class="comment">//frmw-&gt;GetName()</span>
<a name="l00679"></a>00679       <span class="keywordtype">bool</span> res = PrintSubtree(top_name, frmw, frmw_name, prefix, current_level, root_level, <span class="keyword">false</span>, len);
<a name="l00680"></a>00680       <span class="keywordflow">if</span> (!res)
<a name="l00681"></a>00681         <span class="keywordflow">return</span> UVM_ML_COMMAND_FAILURE;
<a name="l00682"></a>00682     };
<a name="l00683"></a>00683   };
<a name="l00684"></a>00684   <span class="keywordflow">if</span> (m_components_unshown_by_depth)
<a name="l00685"></a>00685     PrintMessage(<span class="stringliteral">"Note: the full tree depth is bigger than %d%s,\n"</span>
<a name="l00686"></a>00686                  <span class="stringliteral">"      childen of the components followed by '.../ ...' mark are not shown"</span>, 
<a name="l00687"></a>00687                  m_val.depth, m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#33af73e3cd43ec90d860d456a7c91a74">IsSupplied</a>(DEPTH) ? <span class="stringliteral">""</span> : <span class="stringliteral">" (default value)"</span>);
<a name="l00688"></a>00688   <span class="keywordflow">return</span> UVM_ML_COMMAND_SUCCESS;
<a name="l00689"></a>00689 }
<a name="l00690"></a>00690 
<a name="l00691"></a>00691 <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html">BpInterconnect::BpPredefinedCommand</a>* BpInterconnect::BpCommandPrintTree::m_the_instance = NULL;
<a name="l00692"></a>00692 
<a name="l00693"></a>00693 
<a name="l00694"></a>00694 BpInterconnect::BpCommandPrintTree::BpCommandPrintTree() : m_options()
<a name="l00695"></a>00695 {
<a name="l00696"></a>00696   <span class="keyword">const</span> <span class="keywordtype">char</span> *m_help_msg[] = { <span class="stringliteral">" [-d[epth] depth|all] -s[hort[_path[s]]]] [-p[orts]] [-t[ype]] [-r[oot] path]"</span>,
<a name="l00697"></a>00697                                <span class="stringliteral">"\t-d[epth] depth      the number of levels to display or 'all'"</span>,
<a name="l00698"></a>00698                                <span class="stringliteral">"\t-r[oot] path        the full path to the root node where the display starts"</span>,
<a name="l00699"></a>00699                                <span class="stringliteral">"\t-s[hort[_path[s]]]] display only the component name (short format)"</span>,
<a name="l00700"></a>00700                                <span class="stringliteral">"\t-p[orts]            include ports"</span>,
<a name="l00701"></a>00701                                <span class="stringliteral">"\t-t[ype]             print type names"</span>}; 
<a name="l00702"></a>00702 
<a name="l00703"></a>00703   <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#080ac3986550ea4ef32b073c31c27f47">m_command</a> = <span class="stringliteral">"print_tree"</span>;
<a name="l00704"></a>00704   m_options.SetCommand(<span class="keyword">this</span>);
<a name="l00705"></a>00705   <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#0904edafcb635fc3128ca14ea90f1a58">SetDefaultsAll</a>();
<a name="l00706"></a>00706   <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#23e6ef72d771423fb443165e2e6aa700">m_cmd_help</a>.assign(m_help_msg, m_help_msg+<span class="keyword">sizeof</span>(m_help_msg)/<span class="keyword">sizeof</span>(m_help_msg[0]));
<a name="l00707"></a>00707 }
<a name="l00708"></a>00708 
<a name="l00709"></a>00709 <span class="keyword">const</span> BpInterconnect::BpCommandPrintTree::_option_values BpInterconnect::BpCommandPrintTree::m_defaults = {
<a name="l00710"></a>00710     3,         <span class="comment">//depth</span>
<a name="l00711"></a>00711     <span class="keyword">true</span>,      <span class="comment">//show_full_path</span>
<a name="l00712"></a>00712     <span class="keyword">false</span>,     <span class="comment">//show_port</span>
<a name="l00713"></a>00713     <span class="keyword">false</span>,     <span class="comment">//  show_type</span>
<a name="l00714"></a>00714     string(<span class="stringliteral">""</span>) <span class="comment">//   root_name</span>
<a name="l00715"></a>00715 };
<a name="l00716"></a>00716 
<a name="l00717"></a>00717 
<a name="l00718"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#0904edafcb635fc3128ca14ea90f1a58">00718</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#0904edafcb635fc3128ca14ea90f1a58">BpInterconnect::BpCommandPrintTree::SetDefaultsAll</a>()
<a name="l00719"></a>00719 {
<a name="l00720"></a>00720   m_val = m_defaults;
<a name="l00721"></a>00721   m_components_unshown_by_depth = <span class="keyword">false</span>;
<a name="l00722"></a>00722 };
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 
<a name="l00725"></a>00725 
<a name="l00726"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#778f9c34923bf86157efb9a99a2e78cd">00726</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#778f9c34923bf86157efb9a99a2e78cd">BpInterconnect::BpCommandPrintTree::SetOptionArgument</a>(<span class="keywordtype">int</span> optIndex, <span class="keyword">const</span> <span class="keywordtype">char</span> *argumentPtr)
<a name="l00727"></a>00727 {
<a name="l00728"></a>00728   <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;
<a name="l00729"></a>00729   
<a name="l00730"></a>00730   <span class="keywordflow">switch</span>((<span class="keyword">enum</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#8b17ef60605722ee52ea16e82ddea1f1">options_descr</a>)optIndex)
<a name="l00731"></a>00731   {
<a name="l00732"></a>00732     <span class="keywordflow">case</span> DEPTH:
<a name="l00733"></a>00733     {
<a name="l00734"></a>00734       <span class="keywordtype">long</span> levels = 0;
<a name="l00735"></a>00735       <span class="keywordflow">if</span> (0 == strcmp(argumentPtr, <span class="stringliteral">"all"</span>))
<a name="l00736"></a>00736           levels = -1;
<a name="l00737"></a>00737       <span class="keywordflow">else</span>
<a name="l00738"></a>00738       {
<a name="l00739"></a>00739         <span class="keywordtype">char</span> *endptr = NULL;
<a name="l00740"></a>00740         errno = 0;
<a name="l00741"></a>00741         levels = strtol(argumentPtr, &amp;endptr, 10);
<a name="l00742"></a>00742 
<a name="l00743"></a>00743         <span class="keywordflow">if</span> (errno != 0 || levels &lt;= 0)
<a name="l00744"></a>00744         {
<a name="l00745"></a>00745            stringstream ss;
<a name="l00746"></a>00746            ss &lt;&lt; <span class="stringliteral">"wrong argument of option -depth \""</span> &lt;&lt; argumentPtr &lt;&lt; <span class="stringliteral">"\""</span>;
<a name="l00747"></a>00747            m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(ss);
<a name="l00748"></a>00748            errno = 0;
<a name="l00749"></a>00749            result = <span class="keyword">false</span>;
<a name="l00750"></a>00750         }
<a name="l00751"></a>00751       }
<a name="l00752"></a>00752       <span class="keywordflow">if</span> (result)
<a name="l00753"></a>00753         m_val.depth = levels;     
<a name="l00754"></a>00754     }
<a name="l00755"></a>00755     <span class="keywordflow">break</span>;
<a name="l00756"></a>00756     <span class="keywordflow">case</span> ROOT:<span class="comment">//-root</span>
<a name="l00757"></a>00757       m_val.root_name = argumentPtr;
<a name="l00758"></a>00758       <span class="keywordflow">break</span>;
<a name="l00759"></a>00759     <span class="keywordflow">default</span>:
<a name="l00760"></a>00760       result = <span class="keyword">false</span>;
<a name="l00761"></a>00761       <span class="keywordflow">break</span>;
<a name="l00762"></a>00762   }
<a name="l00763"></a>00763   <span class="keywordflow">return</span> result;
<a name="l00764"></a>00764 }
<a name="l00765"></a>00765 
<a name="l00766"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#fbdbe9061fb79bae477438024a50335f">00766</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#fbdbe9061fb79bae477438024a50335f">BpInterconnect::BpCommandPrintTree::MissedArgumentError</a>(<span class="keywordtype">int</span> optIndex, <span class="keyword">const</span> <span class="keywordtype">char</span> *argumentPtr)
<a name="l00767"></a>00767 {
<a name="l00768"></a>00768   <span class="keywordflow">switch</span>((<span class="keyword">enum</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#8b17ef60605722ee52ea16e82ddea1f1">options_descr</a>)optIndex)
<a name="l00769"></a>00769   {
<a name="l00770"></a>00770     <span class="keywordflow">case</span> DEPTH:
<a name="l00771"></a>00771       <span class="keywordflow">if</span> (!argumentPtr || (argumentPtr[0] == <span class="charliteral">'-'</span>))
<a name="l00772"></a>00772            m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"missing value parameter for depth option (must be a positive integer or 'all')"</span>);
<a name="l00773"></a>00773       <span class="keywordflow">break</span>;
<a name="l00774"></a>00774     <span class="keywordflow">case</span> ROOT:<span class="comment">//-root</span>
<a name="l00775"></a>00775       <span class="keywordflow">if</span> (!argumentPtr || (argumentPtr[0] == <span class="charliteral">'-'</span>))
<a name="l00776"></a>00776            m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"missing path parameter for -root option"</span>);
<a name="l00777"></a>00777       <span class="keywordflow">break</span>;
<a name="l00778"></a>00778      <span class="keywordflow">default</span>: <span class="comment">//the rest of options do not require argument</span>
<a name="l00779"></a>00779        <span class="keywordflow">break</span>;
<a name="l00780"></a>00780   }
<a name="l00781"></a>00781   <span class="keywordflow">return</span> <span class="keyword">false</span>; 
<a name="l00782"></a>00782 }
<a name="l00783"></a>00783 
<a name="l00784"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#5bcd4e15f4716d9b4bce6bea3e48393a">00784</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#5bcd4e15f4716d9b4bce6bea3e48393a">BpInterconnect::BpCommandPrintTree::SetTheOption</a>(<span class="keywordtype">int</span> optIndex)
<a name="l00785"></a>00785 {
<a name="l00786"></a>00786   <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;
<a name="l00787"></a>00787   <span class="keywordflow">switch</span>((<span class="keyword">enum</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintTree.html#8b17ef60605722ee52ea16e82ddea1f1">options_descr</a>)optIndex)
<a name="l00788"></a>00788   {
<a name="l00789"></a>00789     <span class="keywordflow">case</span> FULL_PATH:<span class="comment">//-short</span>
<a name="l00790"></a>00790       m_val.show_full_path = <span class="keyword">false</span>;
<a name="l00791"></a>00791       <span class="keywordflow">break</span>;
<a name="l00792"></a>00792     <span class="keywordflow">case</span> PORTS:<span class="comment">//-ports</span>
<a name="l00793"></a>00793       m_val.show_port = <span class="keyword">true</span>;
<a name="l00794"></a>00794       <span class="keywordflow">break</span>;
<a name="l00795"></a>00795     <span class="keywordflow">case</span> TYPE:<span class="comment">//-types</span>
<a name="l00796"></a>00796       m_val.show_type = <span class="keyword">true</span>;
<a name="l00797"></a>00797       <span class="keywordflow">break</span>;
<a name="l00798"></a>00798     <span class="keywordflow">default</span>:
<a name="l00799"></a>00799       result = <span class="keyword">false</span>;
<a name="l00800"></a>00800   }
<a name="l00801"></a>00801   <span class="keywordflow">return</span> result;
<a name="l00802"></a>00802 }
<a name="l00803"></a>00803 
<a name="l00804"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#4173fb631bc2eaa7fe0140b83a2c15c4">00804</a> <a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">BpInterconnect::exec_status</a> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#4173fb631bc2eaa7fe0140b83a2c15c4">BpInterconnect::BpCommandPrintConnections::Execute</a>(bp_output_cb_t * outputCb,
<a name="l00805"></a>00805                                                                                uvm_ml_time_unit timeUnit,
<a name="l00806"></a>00806                                                                                <span class="keywordtype">double</span> timeValue)
<a name="l00807"></a>00807 {
<a name="l00808"></a>00808   vector&lt; BpConnectionClass * &gt;::iterator it;
<a name="l00809"></a>00809   vector&lt; BpConnectionClass * &gt;::iterator ot;
<a name="l00810"></a>00810 
<a name="l00811"></a>00811   <span class="keywordflow">for</span> (it = m_port_registry.begin(); it != m_port_registry.end(); it++) {
<a name="l00812"></a>00812     vector&lt;BpConnectionClass *&gt;&amp; fanout = (*it)-&gt;GetFanout();
<a name="l00813"></a>00813     <span class="keywordflow">for</span>(ot = fanout.begin(); ot != fanout.end(); ot++) {
<a name="l00814"></a>00814       <span class="keywordflow">if</span>(m_val.root_name == <span class="stringliteral">""</span> || (*it)-&gt;CheckInRange(m_val.root_name)) {
<a name="l00815"></a>00815         PrintPair(*it, *ot, <span class="stringliteral">"    -&gt; "</span>, m_val.show_type);
<a name="l00816"></a>00816       } <span class="keywordflow">else</span> <span class="keywordflow">if</span>((*ot)-&gt;CheckInRange(m_val.root_name)) {
<a name="l00817"></a>00817         PrintPair(*ot, *it, <span class="stringliteral">"    &lt;- "</span>, m_val.show_type);
<a name="l00818"></a>00818       }
<a name="l00819"></a>00819     }
<a name="l00820"></a>00820   }
<a name="l00821"></a>00821   <span class="keywordflow">if</span> (!m_item_is_printed)
<a name="l00822"></a>00822     PrintMessage(<span class="stringliteral">"No UVM-ML connections found."</span>);
<a name="l00823"></a>00823   <span class="keywordflow">return</span> UVM_ML_COMMAND_SUCCESS;
<a name="l00824"></a>00824 }
<a name="l00825"></a>00825 
<a name="l00826"></a>00826 <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html">BpInterconnect::BpPredefinedCommand</a>* BpInterconnect::BpCommandPrintConnections::m_the_instance = NULL;
<a name="l00827"></a>00827 
<a name="l00828"></a>00828 
<a name="l00829"></a>00829 BpInterconnect::BpCommandPrintConnections::BpCommandPrintConnections() : m_options(), m_item_is_printed(false)
<a name="l00830"></a>00830 {
<a name="l00831"></a>00831   <span class="keyword">const</span> <span class="keywordtype">char</span> *m_help_msg[] = {<span class="stringliteral">" [-t[ype]] [-r[oot] path]"</span>,
<a name="l00832"></a>00832                               <span class="stringliteral">"\t-r[oot]  path   the full path to the root node where the display starts"</span>,
<a name="l00833"></a>00833                               <span class="stringliteral">"\t-t[ype]         print type names"</span>};
<a name="l00834"></a>00834 
<a name="l00835"></a>00835   <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#080ac3986550ea4ef32b073c31c27f47">m_command</a> = <span class="stringliteral">"print_connections"</span>;
<a name="l00836"></a>00836   m_options.SetCommand(<span class="keyword">this</span>);
<a name="l00837"></a>00837   <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#635066ffc1fc15e58eb52233acf4eb8f">SetDefaultsAll</a>();
<a name="l00838"></a>00838   <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#23e6ef72d771423fb443165e2e6aa700">m_cmd_help</a>.assign(m_help_msg, m_help_msg+<span class="keyword">sizeof</span>(m_help_msg)/<span class="keyword">sizeof</span>(m_help_msg[0]));
<a name="l00839"></a>00839 }
<a name="l00840"></a>00840 
<a name="l00841"></a>00841 <span class="keyword">const</span> BpInterconnect::BpCommandPrintConnections::_option_values BpInterconnect::BpCommandPrintConnections::m_defaults = {
<a name="l00842"></a>00842     <span class="keyword">false</span>,     <span class="comment">//  show_type</span>
<a name="l00843"></a>00843     string(<span class="stringliteral">""</span>) <span class="comment">//   root_name</span>
<a name="l00844"></a>00844 };
<a name="l00845"></a>00845 
<a name="l00846"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#635066ffc1fc15e58eb52233acf4eb8f">00846</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#635066ffc1fc15e58eb52233acf4eb8f">BpInterconnect::BpCommandPrintConnections::SetDefaultsAll</a>()
<a name="l00847"></a>00847 {
<a name="l00848"></a>00848   m_val = m_defaults;
<a name="l00849"></a>00849   m_item_is_printed = <span class="keyword">false</span>;
<a name="l00850"></a>00850 };
<a name="l00851"></a>00851 
<a name="l00852"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#32d06509a48f0f9be9b26283f5db50af">00852</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#32d06509a48f0f9be9b26283f5db50af">BpInterconnect::BpCommandPrintConnections::SetOptionArgument</a>(<span class="keywordtype">int</span> optIndex, <span class="keyword">const</span> <span class="keywordtype">char</span> *argumentPtr)
<a name="l00853"></a>00853 {
<a name="l00854"></a>00854   m_val.root_name = argumentPtr; <span class="comment">//the only with required argument is -root</span>
<a name="l00855"></a>00855   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00856"></a>00856 }
<a name="l00857"></a>00857 
<a name="l00858"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#1b62ae7d7a8167695271022987c7baa3">00858</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#1b62ae7d7a8167695271022987c7baa3">BpInterconnect::BpCommandPrintConnections::SetTheOption</a>(<span class="keywordtype">int</span> optIndex)
<a name="l00859"></a>00859 {
<a name="l00860"></a>00860   m_val.show_type = <span class="keyword">true</span>; <span class="comment">//the only option switch is -type</span>
<a name="l00861"></a>00861   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00862"></a>00862 }
<a name="l00863"></a>00863 
<a name="l00864"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#61f0091db0ce43bcd85a9bc82e11abc9">00864</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#61f0091db0ce43bcd85a9bc82e11abc9">BpInterconnect::BpCommandPrintConnections::MissedArgumentError</a>(<span class="keywordtype">int</span> optIndex, <span class="keyword">const</span> <span class="keywordtype">char</span> *argumentPtr)
<a name="l00865"></a>00865 {
<a name="l00866"></a>00866   <span class="keywordflow">switch</span>((<span class="keyword">enum</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPrintConnections.html#61c942633669c06e359776fe9d1175bf">options_descr</a>)optIndex)
<a name="l00867"></a>00867   {
<a name="l00868"></a>00868     <span class="keywordflow">case</span> ROOT:<span class="comment">//-root</span>
<a name="l00869"></a>00869       <span class="keywordflow">if</span> (!argumentPtr || (argumentPtr[0] == <span class="charliteral">'-'</span>))
<a name="l00870"></a>00870            m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"missing value parameter for depth option (must be a positive integer or 'all')"</span>);
<a name="l00871"></a>00871       <span class="keywordflow">break</span>;
<a name="l00872"></a>00872     <span class="keywordflow">default</span>:
<a name="l00873"></a>00873       <span class="keywordflow">break</span>;
<a name="l00874"></a>00874   }
<a name="l00875"></a>00875   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00876"></a>00876 }
<a name="l00877"></a>00877 
<a name="l00878"></a>00878 
<a name="l00879"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#5d6abe6f5ac76b845a199287cd219e18">00879</a> <a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">BpInterconnect::exec_status</a> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#5d6abe6f5ac76b845a199287cd219e18">BpInterconnect::BpCommandPhase::Execute</a>(bp_output_cb_t * outputCb,
<a name="l00880"></a>00880                                                                     uvm_ml_time_unit timeUnit,
<a name="l00881"></a>00881                                                                     <span class="keywordtype">double</span> timeValue)
<a name="l00882"></a>00882 {
<a name="l00883"></a>00883   <a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">exec_status</a> status = UVM_ML_COMMAND_SUCCESS;
<a name="l00884"></a>00884   uvm_ml_phase_action phase_action = ((m_val.which_end != end) ? UVM_ML_PHASE_STARTED :  UVM_ML_PHASE_ENDED);
<a name="l00885"></a>00885   <span class="keywordflow">switch</span>(m_mandatory_variant_selector)
<a name="l00886"></a>00886   {
<a name="l00887"></a>00887     <span class="keywordflow">case</span> STOP_AT:
<a name="l00888"></a>00888     <span class="keywordflow">case</span> RUN:
<a name="l00889"></a>00889       <span class="keywordflow">if</span> (!<a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#9d8c1adfeb2da0fff2fb3e7794148a73">BpStopRequestClass::RequestStopPhase</a>(m_val.act_phase.c_str(), phase_action))
<a name="l00890"></a>00890         status = UVM_ML_COMMAND_FAILURE;
<a name="l00891"></a>00891       <span class="keywordflow">break</span>;
<a name="l00892"></a>00892     <span class="keywordflow">case</span> REMOVE_STOP:
<a name="l00893"></a>00893       <span class="keywordflow">if</span> (m_val.all_stops)
<a name="l00894"></a>00894         <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#4ecbc39a4822d8fc0636a9d9e4f255cd">BpStopRequestClass::CancelPhaseRequests</a>();
<a name="l00895"></a>00895       <span class="keywordflow">else</span>
<a name="l00896"></a>00896         <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#0b3cfc06e696a812aed604f6a416aeff">BpStopRequestClass::CancelStopPhase</a>(m_val.act_phase.c_str(), phase_action);
<a name="l00897"></a>00897       <span class="keywordflow">break</span>;
<a name="l00898"></a>00898     <span class="keywordflow">case</span> GET:
<a name="l00899"></a>00899       <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#9a9907d31c19212f3c24ca98631e6458">BpStopRequestClass::GetPhaseRequest</a>();
<a name="l00900"></a>00900       <span class="keywordflow">break</span>;
<a name="l00901"></a>00901     <span class="keywordflow">case</span> LIST_STOP:
<a name="l00902"></a>00902       <a class="code" href="classBp_1_1BpInterconnect_1_1BpStopRequestClass.html#b848db15f3c1fab2dc2423728228b7ad">BpStopRequestClass::ListStopRequests</a>();
<a name="l00903"></a>00903       <span class="keywordflow">break</span>;
<a name="l00904"></a>00904   }     
<a name="l00905"></a>00905   <span class="keywordflow">return</span> status;
<a name="l00906"></a>00906 }
<a name="l00907"></a>00907 
<a name="l00908"></a>00908 <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html">BpInterconnect::BpPredefinedCommand</a>* BpInterconnect::BpCommandPhase::m_the_instance = NULL;
<a name="l00909"></a>00909 
<a name="l00910"></a>00910 
<a name="l00911"></a>00911 <span class="comment">//constant (-1) for support of m_mandatory_variant_selector of the phase command</span>
<a name="l00912"></a>00912 <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#8b010a4d39d577e5caa1ec1e089d1cea">BpInterconnect::BpCommandPhase::NO_MANDATORY_VARIANT</a> = UNKNOWN;
<a name="l00913"></a>00913 
<a name="l00914"></a>00914 BpInterconnect::BpCommandPhase::BpCommandPhase() : m_mandatory_variant_selector(NO_MANDATORY_VARIANT), m_options(m_mandatory_variant_selector)
<a name="l00915"></a>00915 {
<a name="l00916"></a>00916   <span class="keyword">const</span> <span class="keywordtype">char</span>* m_help_msg[] = {<span class="stringliteral">" -stop_at (((-begin | -end) &lt;phase_name&gt;) | -build_done)"</span>,
<a name="l00917"></a>00917                               <span class="stringliteral">"uvm_ml phase -remove_stop (((-begin | -end) &lt;phase_name&gt;) | -all)"</span>,
<a name="l00918"></a>00918                               <span class="stringliteral">"uvm_ml phase -run &lt;phase_name&gt;"</span>,
<a name="l00919"></a>00919                               <span class="stringliteral">"uvm_ml phase -list_stop"</span>,
<a name="l00920"></a>00920                               <span class="stringliteral">"uvm_ml phase -get"</span>,
<a name="l00921"></a>00921                               <span class="stringliteral">"\t-stop_at      set breakpoint at the beginning or end of the phase"</span>,
<a name="l00922"></a>00922                               <span class="stringliteral">"\t-remove_stop  remove the breakpoint"</span>,
<a name="l00923"></a>00923                               <span class="stringliteral">"\t-run phase    set break at the beginning of the phase and resume the session"</span>,
<a name="l00924"></a>00924                               <span class="stringliteral">"\t-list_stop    list the pending stop requests"</span>,
<a name="l00925"></a>00925                               <span class="stringliteral">"\t-get          display current phase"</span>};
<a name="l00926"></a>00926 
<a name="l00927"></a>00927 
<a name="l00928"></a>00928   <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#080ac3986550ea4ef32b073c31c27f47">m_command</a> = <span class="stringliteral">"phase"</span>; 
<a name="l00929"></a>00929   m_options.SetCommand(<span class="keyword">this</span>);
<a name="l00930"></a>00930   <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#78b4532666eb422aacfd671c3162f0aa">SetDefaultsAll</a>();
<a name="l00931"></a>00931   <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#23e6ef72d771423fb443165e2e6aa700">m_cmd_help</a>.assign(m_help_msg, m_help_msg+<span class="keyword">sizeof</span>(m_help_msg)/<span class="keyword">sizeof</span>(m_help_msg[0]));
<a name="l00932"></a>00932 }
<a name="l00933"></a>00933 
<a name="l00934"></a>00934 <span class="keyword">const</span> BpInterconnect::BpCommandPhase::_option_values BpInterconnect::BpCommandPhase::m_defaults = {
<a name="l00935"></a>00935     <span class="keyword">false</span>,     <span class="comment">//  mandatory_variant flag </span>
<a name="l00936"></a>00936     string(<span class="stringliteral">""</span>), <span class="comment">//   the phase to act upon</span>
<a name="l00937"></a>00937     BpCommandPhase::unknown, <span class="comment">//should be begin or end of phase</span>
<a name="l00938"></a>00938     <span class="keyword">false</span>       <span class="comment">//all stops - only for the sub-command -remove_stop</span>
<a name="l00939"></a>00939 };
<a name="l00940"></a>00940 
<a name="l00941"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#78b4532666eb422aacfd671c3162f0aa">00941</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#78b4532666eb422aacfd671c3162f0aa">BpInterconnect::BpCommandPhase::SetDefaultsAll</a>()
<a name="l00942"></a>00942 {
<a name="l00943"></a>00943   m_val = m_defaults;
<a name="l00944"></a>00944 };
<a name="l00945"></a>00945 
<a name="l00946"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#8e2911cd1f08c819dd62e8ed2f076425">00946</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#8e2911cd1f08c819dd62e8ed2f076425">BpInterconnect::BpCommandPhase::SetMandatoryOptionVariant</a>(<span class="keywordtype">int</span> selector) 
<a name="l00947"></a>00947 { 
<a name="l00948"></a>00948   m_mandatory_variant_selector = selector; 
<a name="l00949"></a>00949 }
<a name="l00950"></a>00950 
<a name="l00951"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#5e5a5a95dad4526120672f968c74bc5e">00951</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#5e5a5a95dad4526120672f968c74bc5e">BpInterconnect::BpCommandPhase::SetOptionArgument</a>(<span class="keywordtype">int</span> optIndex, <span class="keyword">const</span> <span class="keywordtype">char</span> *argumentPtr)
<a name="l00952"></a>00952 {
<a name="l00953"></a>00953   <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;
<a name="l00954"></a>00954 
<a name="l00955"></a>00955   <span class="keywordflow">if</span> (AmbiguousPhaseParameter())
<a name="l00956"></a>00956     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00957"></a>00957 
<a name="l00958"></a>00958   <span class="keywordflow">switch</span>( m_mandatory_variant_selector)
<a name="l00959"></a>00959   {
<a name="l00960"></a>00960     <span class="keywordflow">case</span> STOP_AT:
<a name="l00961"></a>00961     <span class="keywordflow">case</span> REMOVE_STOP:
<a name="l00962"></a>00962       m_val.act_phase = argumentPtr;
<a name="l00963"></a>00963       m_val.which_end  = (optIndex == BEGIN) ? begin : end;
<a name="l00964"></a>00964       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00965"></a>00965     <span class="keywordflow">case</span> RUN:
<a name="l00966"></a>00966       <span class="keywordflow">if</span>(m_orignated_framework_id != -1) <span class="comment">//running should be called interactively only</span>
<a name="l00967"></a>00967       {
<a name="l00968"></a>00968         WarningMsg(<span class="stringliteral">"Specman 'run' command cannot be used in the mixed language UVM mode and it is ignored."</span>);
<a name="l00969"></a>00969         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00970"></a>00970       }
<a name="l00971"></a>00971       m_val.act_phase = argumentPtr;
<a name="l00972"></a>00972       m_val.which_end = begin;
<a name="l00973"></a>00973       m_val.mandatory_option = <span class="keyword">true</span>;
<a name="l00974"></a>00974       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00975"></a>00975     <span class="keywordflow">default</span>:
<a name="l00976"></a>00976       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00977"></a>00977   }
<a name="l00978"></a>00978   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00979"></a>00979 }
<a name="l00980"></a>00980 
<a name="l00981"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#6d0007dea3031a90e95ea96a178ed3f6">00981</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#6d0007dea3031a90e95ea96a178ed3f6">BpInterconnect::BpCommandPhase::SetTheOption</a>(<span class="keywordtype">int</span> optIndex)
<a name="l00982"></a>00982 {
<a name="l00983"></a>00983   <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;
<a name="l00984"></a>00984   <span class="keywordflow">if</span> (optIndex == MANDATORY_OPTION)
<a name="l00985"></a>00985     m_val.mandatory_option = <span class="keyword">true</span>;
<a name="l00986"></a>00986   <span class="keywordflow">else</span>
<a name="l00987"></a>00987   {
<a name="l00988"></a>00988     <span class="keywordflow">if</span> (AmbiguousPhaseParameter())
<a name="l00989"></a>00989       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00990"></a>00990     <span class="keywordflow">switch</span>(m_mandatory_variant_selector)
<a name="l00991"></a>00991     {
<a name="l00992"></a>00992       <span class="keywordflow">case</span> STOP_AT:<span class="comment">//-build_done</span>
<a name="l00993"></a>00993         m_val.act_phase = <span class="stringliteral">"build"</span>;
<a name="l00994"></a>00994         m_val.which_end = end;
<a name="l00995"></a>00995         <span class="keywordflow">break</span>;
<a name="l00996"></a>00996       <span class="keywordflow">case</span> REMOVE_STOP: <span class="comment">//-all</span>
<a name="l00997"></a>00997         m_val.all_stops = <span class="keyword">true</span>;
<a name="l00998"></a>00998         <span class="keywordflow">break</span>;
<a name="l00999"></a>00999      <span class="keywordflow">default</span>:
<a name="l01000"></a>01000        result = <span class="keyword">false</span>;
<a name="l01001"></a>01001     }    
<a name="l01002"></a>01002   }
<a name="l01003"></a>01003   <span class="keywordflow">return</span> result;
<a name="l01004"></a>01004 }
<a name="l01005"></a>01005 
<a name="l01006"></a>01006 <span class="keywordtype">bool</span> BpInterconnect::BpCommandPhase::AmbiguousPhaseParameter()
<a name="l01007"></a>01007 {
<a name="l01008"></a>01008   <span class="keywordflow">if</span> (! m_val.act_phase.empty())
<a name="l01009"></a>01009   {
<a name="l01010"></a>01010     <span class="keywordflow">switch</span>(m_mandatory_variant_selector)
<a name="l01011"></a>01011     {
<a name="l01012"></a>01012       <span class="keywordflow">case</span> STOP_AT:<span class="comment">//-build_done</span>
<a name="l01013"></a>01013         m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"only 1 -stop_at parameter allowed"</span>);
<a name="l01014"></a>01014         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01015"></a>01015       <span class="keywordflow">case</span> REMOVE_STOP: <span class="comment">//-all</span>
<a name="l01016"></a>01016         m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"only 1 -remove_stop parameter allowed"</span>);
<a name="l01017"></a>01017         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01018"></a>01018       <span class="keywordflow">default</span>:
<a name="l01019"></a>01019         <span class="keywordflow">break</span>;
<a name="l01020"></a>01020     }
<a name="l01021"></a>01021   }
<a name="l01022"></a>01022   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01023"></a>01023 }
<a name="l01024"></a>01024 
<a name="l01025"></a>01025 
<a name="l01026"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#5d091f6fdda7f3b93d6b1f4b0af8f9c4">01026</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#5d091f6fdda7f3b93d6b1f4b0af8f9c4">BpInterconnect::BpCommandPhase::MissedArgumentError</a>(<span class="keywordtype">int</span> optIndex, <span class="keyword">const</span> <span class="keywordtype">char</span> *argumentPtr)
<a name="l01027"></a>01027 {
<a name="l01028"></a>01028   <span class="keywordflow">switch</span>(optIndex)
<a name="l01029"></a>01029   {
<a name="l01030"></a>01030     <span class="keywordflow">case</span> MANDATORY_OPTION:
<a name="l01031"></a>01031       m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"no phase parameter supplied for the option -run"</span>);
<a name="l01032"></a>01032       <span class="keywordflow">break</span>;
<a name="l01033"></a>01033     <span class="keywordflow">case</span> BEGIN: 
<a name="l01034"></a>01034       m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"no phase parameter supplied for the option -begin"</span>);
<a name="l01035"></a>01035       <span class="keywordflow">break</span>;
<a name="l01036"></a>01036     <span class="keywordflow">case</span> END: 
<a name="l01037"></a>01037       m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"no phase parameter supplied for the option -end"</span>);
<a name="l01038"></a>01038       <span class="keywordflow">break</span>;
<a name="l01039"></a>01039     <span class="keywordflow">default</span>:
<a name="l01040"></a>01040       <span class="keywordflow">break</span>;
<a name="l01041"></a>01041   }
<a name="l01042"></a>01042   <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">//phase cannot execute with missing argument for any option</span>
<a name="l01043"></a>01043 }
<a name="l01044"></a>01044 
<a name="l01045"></a>01045 <span class="comment">//to check contradicting or missing flags/arguments</span>
<a name="l01046"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#eb1bcb6c9c7195ba43c3d50f88bbd10e">01046</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandPhase.html#eb1bcb6c9c7195ba43c3d50f88bbd10e">BpInterconnect::BpCommandPhase::QueryOptionsConsistency</a>()
<a name="l01047"></a>01047 {
<a name="l01048"></a>01048   <span class="keywordflow">if</span> (!m_val.mandatory_option)
<a name="l01049"></a>01049     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01050"></a>01050 
<a name="l01051"></a>01051   <span class="comment">//check the phase to be fully specified</span>
<a name="l01052"></a>01052   <span class="keywordflow">switch</span>(m_mandatory_variant_selector)
<a name="l01053"></a>01053   {
<a name="l01054"></a>01054     <span class="keywordflow">case</span> STOP_AT:
<a name="l01055"></a>01055       <span class="keywordflow">if</span> (!m_val.act_phase.empty())
<a name="l01056"></a>01056         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01057"></a>01057       m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"could not stop at unspecified phase. Please provide a phase parameter to the option -stop_at"</span>);
<a name="l01058"></a>01058       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01059"></a>01059     <span class="keywordflow">case</span> REMOVE_STOP:
<a name="l01060"></a>01060       <span class="keywordflow">if</span> (m_val.all_stops)
<a name="l01061"></a>01061         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01062"></a>01062       <span class="keywordflow">if</span> (!m_val.act_phase.empty())
<a name="l01063"></a>01063         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01064"></a>01064       m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"could not remove breakpoint at unspecified phase. Please provide a phase parameter to the option -remove_stop"</span>);
<a name="l01065"></a>01065       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01066"></a>01066     <span class="keywordflow">case</span> RUN:
<a name="l01067"></a>01067       <span class="keywordflow">return</span> !m_val.act_phase.empty(); <span class="comment">//handled on parsing the -run option</span>
<a name="l01068"></a>01068     <span class="keywordflow">case</span> GET:
<a name="l01069"></a>01069     <span class="keywordflow">case</span> LIST_STOP:
<a name="l01070"></a>01070     <span class="keywordflow">case</span> HELP:
<a name="l01071"></a>01071       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01072"></a>01072   }
<a name="l01073"></a>01073   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01074"></a>01074 }
<a name="l01075"></a>01075 
<a name="l01076"></a>01076 <a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">BpInterconnect::exec_status</a> 
<a name="l01077"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#adb0089a243def1a22f4e68e025f3c12">01077</a> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#adb0089a243def1a22f4e68e025f3c12">BpInterconnect::BpCommandTraceRegister::Execute</a>(bp_output_cb_t * outputCb,
<a name="l01078"></a>01078                                                 uvm_ml_time_unit timeUnit,
<a name="l01079"></a>01079                                                 <span class="keywordtype">double</span>           timeValue)
<a name="l01080"></a>01080 {
<a name="l01081"></a>01081   <span class="keywordflow">return</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#97aca509959ee2a498f7c595f4a12200">DoBroadcastCommand</a>(outputCb,
<a name="l01082"></a>01082                             timeUnit,
<a name="l01083"></a>01083                             timeValue);
<a name="l01084"></a>01084 }
<a name="l01085"></a>01085 
<a name="l01086"></a>01086 <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html">BpInterconnect::BpPredefinedCommand</a>* BpInterconnect::BpCommandTraceRegister::m_the_instance = NULL;
<a name="l01087"></a>01087 
<a name="l01088"></a>01088 
<a name="l01089"></a>01089 BpInterconnect::BpCommandTraceRegister::BpCommandTraceRegister() : m_options(), m_command_lens()
<a name="l01090"></a>01090 {
<a name="l01091"></a>01091   <span class="keyword">const</span> <span class="keywordtype">char</span> *m_help_line = { <span class="stringliteral">" -on | -off | -h[elp]"</span>};
<a name="l01092"></a>01092 
<a name="l01093"></a>01093   <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#080ac3986550ea4ef32b073c31c27f47">m_command</a> = <span class="stringliteral">"trace_register_tlm"</span>;<span class="comment">//trace_register[_tlm]</span>
<a name="l01094"></a>01094   m_command_lens.insert((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(strlen(<span class="stringliteral">"trace_register"</span>))); <span class="comment">//shortened variant length</span>
<a name="l01095"></a>01095   m_options.SetCommand(<span class="keyword">this</span>);
<a name="l01096"></a>01096   <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#98d28d9a62938cbb55cfd26c5000e334">SetDefaultsAll</a>();
<a name="l01097"></a>01097   <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#23e6ef72d771423fb443165e2e6aa700">m_cmd_help</a>.push_back(m_help_line);
<a name="l01098"></a>01098 }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100 <span class="comment">//override the virtual function for the command trace_register[_tlm] having two variants of basename</span>
<a name="l01101"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#d61eebeeb600aa737183e821dd063507">01101</a> string <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#d61eebeeb600aa737183e821dd063507">BpInterconnect::BpCommandTraceRegister::Name</a>()
<a name="l01102"></a>01102 {
<a name="l01103"></a>01103   string resName = <span class="stringliteral">"uvm_ml "</span>; <span class="comment">//common prefix</span>
<a name="l01104"></a>01104   size_t prev_pos=0;
<a name="l01105"></a>01105   <span class="keywordflow">for</span> (set&lt;unsigned char&gt;::iterator it = m_command_lens.begin();
<a name="l01106"></a>01106        it != m_command_lens.end();
<a name="l01107"></a>01107        it++)
<a name="l01108"></a>01108   {
<a name="l01109"></a>01109     resName += <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#080ac3986550ea4ef32b073c31c27f47">m_command</a>.substr(prev_pos, *it-prev_pos) + <span class="charliteral">'['</span>;
<a name="l01110"></a>01110     prev_pos = *it;
<a name="l01111"></a>01111   }
<a name="l01112"></a>01112   resName += <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#080ac3986550ea4ef32b073c31c27f47">m_command</a>.substr(prev_pos); <span class="comment">//up to the end of string</span>
<a name="l01113"></a>01113   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = m_command_lens.size(); i &gt; 0 ; i--)
<a name="l01114"></a>01114     resName += <span class="charliteral">']'</span>;
<a name="l01115"></a>01115   <span class="keywordflow">return</span> resName;
<a name="l01116"></a>01116 }
<a name="l01117"></a>01117 
<a name="l01118"></a>01118 <span class="comment">//override the virtual function to check for both variants of the command trace_register[_tlm] </span>
<a name="l01119"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#094e7609142e667445ac90746293120d">01119</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#094e7609142e667445ac90746293120d">BpInterconnect::BpCommandTraceRegister::MatchCommand</a>(<span class="keyword">const</span> string &amp; command_with_arguments)
<a name="l01120"></a>01120 {
<a name="l01121"></a>01121   <span class="keywordtype">bool</span> matches =  <a class="code" href="classBp_1_1BpInterconnect_1_1BpPredefinedCommand.html#43fb10b1ea19edaa97a6c1800ba3a58c">MatchesCommandName</a>(command_with_arguments);
<a name="l01122"></a>01122   <span class="keywordflow">if</span> (!matches)
<a name="l01123"></a>01123   {
<a name="l01124"></a>01124     string basename = GetToken(command_with_arguments);
<a name="l01125"></a>01125     matches = (m_command_lens.find((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(basename.length())) != m_command_lens.end());
<a name="l01126"></a>01126   }
<a name="l01127"></a>01127   <span class="keywordflow">return</span> matches;
<a name="l01128"></a>01128 }
<a name="l01129"></a>01129 
<a name="l01130"></a>01130 <span class="keyword">const</span> BpInterconnect::BpCommandTraceRegister::_option_values 
<a name="l01131"></a>01131 BpInterconnect::BpCommandTraceRegister::m_defaults = {
<a name="l01132"></a>01132   UNKNOWN  <span class="comment">//yet not defined</span>
<a name="l01133"></a>01133 };
<a name="l01134"></a>01134 
<a name="l01135"></a>01135 
<a name="l01136"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#98d28d9a62938cbb55cfd26c5000e334">01136</a> <span class="keywordtype">void</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#98d28d9a62938cbb55cfd26c5000e334">BpInterconnect::BpCommandTraceRegister::SetDefaultsAll</a>()
<a name="l01137"></a>01137 {
<a name="l01138"></a>01138   m_val = m_defaults;
<a name="l01139"></a>01139 };
<a name="l01140"></a>01140 
<a name="l01141"></a>01141 
<a name="l01142"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#3a1cdbe33c35d5a56fbdae2f3c562d31">01142</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#3a1cdbe33c35d5a56fbdae2f3c562d31">BpInterconnect::BpCommandTraceRegister::SetOptionArgument</a>(<span class="keywordtype">int</span> optIndex, <span class="keyword">const</span> <span class="keywordtype">char</span> *argumentPtr)
<a name="l01143"></a>01143 {
<a name="l01144"></a>01144   <span class="keywordflow">return</span> <span class="keyword">true</span>;<span class="comment">//no arguments for this command</span>
<a name="l01145"></a>01145 }
<a name="l01146"></a>01146 
<a name="l01147"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#efabc58fe51d9bcc1b5a8ab51c3a7eaf">01147</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#efabc58fe51d9bcc1b5a8ab51c3a7eaf">BpInterconnect::BpCommandTraceRegister::SetTheOption</a>(<span class="keywordtype">int</span> optIndex)
<a name="l01148"></a>01148 {
<a name="l01149"></a>01149   <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;
<a name="l01150"></a>01150   <span class="keywordflow">if</span> (m_val.trace_switch != UNKNOWN)
<a name="l01151"></a>01151   {
<a name="l01152"></a>01152     m_options.<a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandOptionsBase.html#f7b17511c3d58f9c4413328a472cdf92">ReportError</a>(<span class="stringliteral">"only 1 trace_register parameter allowed"</span>);
<a name="l01153"></a>01153     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01154"></a>01154   }
<a name="l01155"></a>01155   <span class="keywordflow">switch</span>((<span class="keyword">enum</span> options_descr)optIndex)
<a name="l01156"></a>01156   {
<a name="l01157"></a>01157     <span class="keywordflow">case</span> ON:<span class="comment">//-on</span>
<a name="l01158"></a>01158       m_val.trace_switch = ON;
<a name="l01159"></a>01159       <span class="keywordflow">break</span>;
<a name="l01160"></a>01160     <span class="keywordflow">case</span> OFF:<span class="comment">//-off</span>
<a name="l01161"></a>01161       m_val.trace_switch = OFF;
<a name="l01162"></a>01162       <span class="keywordflow">break</span>;
<a name="l01163"></a>01163     <span class="keywordflow">default</span>:
<a name="l01164"></a>01164       result = <span class="keyword">false</span>;
<a name="l01165"></a>01165   }
<a name="l01166"></a>01166   <span class="keywordflow">return</span> result;
<a name="l01167"></a>01167 }
<a name="l01168"></a>01168 
<a name="l01169"></a>01169 
<a name="l01170"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#8d301f508d5443aa65f409b4f1dd4e35">01170</a> <span class="keywordtype">bool</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandTraceRegister.html#8d301f508d5443aa65f409b4f1dd4e35">BpInterconnect::BpCommandTraceRegister::QueryOptionsConsistency</a>()
<a name="l01171"></a>01171 {
<a name="l01172"></a>01172   <span class="keywordflow">if</span> (m_val.trace_switch == UNKNOWN)
<a name="l01173"></a>01173   {
<a name="l01174"></a>01174     <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#0d2b105156dadb3fac3267d068d6dbf0">m_external_cmd_line</a> += <span class="stringliteral">" -on"</span>;
<a name="l01175"></a>01175   }
<a name="l01176"></a>01176   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01177"></a>01177 }
<a name="l01178"></a>01178 
<a name="l01179"></a>01179 <a class="code" href="classBp_1_1BpInterconnect.html#bb7e2c206a2e2a7841a89d22bf2469a2">BpInterconnect::exec_status</a> 
<a name="l01180"></a><a class="code" href="classBp_1_1BpInterconnect_1_1BpCustomCommand.html#e9877b5dd22d5a65c4e07076167e1eff">01180</a> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCustomCommand.html#e9877b5dd22d5a65c4e07076167e1eff">BpInterconnect::BpCustomCommand::Execute</a>(bp_output_cb_t * outputCb,
<a name="l01181"></a>01181                                          uvm_ml_time_unit timeUnit,
<a name="l01182"></a>01182                                          <span class="keywordtype">double</span>           timeValue)
<a name="l01183"></a>01183 {
<a name="l01184"></a>01184   <span class="keywordflow">return</span> <a class="code" href="classBp_1_1BpInterconnect_1_1BpCommandBase.html#97aca509959ee2a498f7c595f4a12200">DoBroadcastCommand</a>(outputCb,
<a name="l01185"></a>01185                              timeUnit,
<a name="l01186"></a>01186                              timeValue,
<a name="l01187"></a>01187                              <span class="keyword">false</span>);
<a name="l01188"></a>01188 }
<a name="l01189"></a>01189 
<a name="l01190"></a>01190 <a class="code" href="classBp_1_1BpInterconnect_1_1BpCustomCommand.html">BpInterconnect::BpCustomCommand</a>* BpInterconnect::BpCustomCommand::m_the_instance = NULL;
<a name="l01191"></a>01191 
<a name="l01192"></a>01192 } <span class="comment">// end namespace Bp</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Aug 23 11:20:56 2015 for UVM-ML by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
